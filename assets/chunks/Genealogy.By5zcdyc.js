import{d as et,k as $,h as _,l as Ne,y as tt,v as nt,c as v,o as m,n as ie,m as u,t as Y,e as W,a as ne,a0 as ge,F as H,C as q,a5 as pe,a6 as st,a7 as Ae,p as Xe,R as ot,_ as at}from"./framework.Cer6JMjx.js";async function rt(){try{const n=await fetch("/genealogy/schemas.json");if(!n.ok)throw new Error("Failed to load schemas data");return await n.json()}catch(n){return console.error("Error loading schemas:",n),[]}}function L(n){return parseInt(n.substring(0,4),10)}function lt(n){const o=parseInt(n.substring(0,4),10),l=parseInt(n.substring(4,6),10)||1,a=parseInt(n.substring(6,8),10)||1;return new Date(o,l-1,a)}function it(n){const o=n.substring(0,4),l=n.substring(4,6),a=n.substring(6,8);return l==="00"?`${o}å¹´`:a==="00"?`${o}å¹´${parseInt(l)}æœˆ`:`${o}å¹´${parseInt(l)}æœˆ${parseInt(a)}æ—¥`}function Oe(n){const o=n.substring(0,4),l=n.substring(4,6);return l==="00"?`${o}å¹´`:`${o}å¹´${parseInt(l)}æœˆ`}function Le(n,o=!1){const l=[...n].sort((a,r)=>{const d=parseInt(a.date),c=parseInt(r.date);return d-c});return o?l.reverse():l}function ut(n,o=30,l=90,a=3,r=60){if(n.length===0)return new Map;const d=n.map(y=>L(y.date)),c=Math.min(...d),b=Math.max(...d),C=new Map;n.forEach(y=>{const g=L(y.date);C.set(g,(C.get(g)||0)+1)});const M=[];let E=null;for(let y=c;y<=b;y++)if((C.get(y)||0)===0)E===null&&(E=y);else if(E!==null){const w=y-E;w>=a&&M.push({startYear:E,endYear:y-1,length:w}),E=null}if(E!==null){const y=b-E+1;y>=a&&M.push({startYear:E,endYear:b,length:y})}const h=new Map;let i=0;for(let y=c;y<=b;y++){h.set(y,i);const g=C.get(y)||0,w=M.find(k=>y>=k.startYear&&y<=k.endYear);g>0?i+=o+g*l:w&&y===w.startYear?i+=r:w||(i+=o)}return h}function Pe(n,o,l=3,a=5){if(n.length===0)return[];const r=n.map(h=>L(h.date)),d=Math.min(...r),c=Math.max(...r),b=new Map;n.forEach(h=>{const i=L(h.date);b.set(i,(b.get(i)||0)+1)});for(let h=d;h<=c;h++)b.get(h);const C=[],M=5,E=2;for(let h=d;h<=c;h++){const i=o.get(h)||0;if(b.get(h),h%M===0||(h===d||h===c)){let w=!1;for(let k=h-E;k<=h+E;k++)if((b.get(k)||0)>0){w=!0;break}w&&C.push({year:h,y:i})}}return C}function ct(n,o,l,a=30,r=90,d){const c=L(n.date),b=lt(n.date),C=l.get(c)||0,M=new Date(c,0,1),h=new Date(c,11,31).getTime()-M.getTime(),y=(b.getTime()-M.getTime())/h;let g=a+r;if(d){const k=d.filter(P=>L(P.date)===c).length;k>0&&(g=a+k*r)}return C+y*g}function dt(n){const o=new Set;return n.forEach(l=>{l.features.forEach(a=>o.add(a))}),Array.from(o).sort()}function ht(n){const o=new Set;return n.forEach(l=>{l.authors.forEach(a=>o.add(a)),l.maintainers&&l.maintainers.forEach(a=>o.add(a))}),Array.from(o).sort()}function ft(n){if(n.length===0)return{minYear:0,maxYear:0};const o=n.map(l=>L(l.date));return{minYear:Math.min(...o),maxYear:Math.max(...o)}}function ue(n,o){let l=0;for(let a=0;a<n.length;a++){const r=n.charCodeAt(a);r>=19968&&r<=40959||r>=13312&&r<=19903||r>=131072&&r<=173791?o?l+=15:l+=12:o?l+=10:l+=7}return l}function vt(n){const o=ue(n.name,!0),l=ue(n.authors.join(" "),!1),a=n.maintainers?ue(n.maintainers.join(" "),!1):0,r=ue(Oe(n.date),!1),d=Math.max(o,l,a,r);return Math.max(60,Math.min(350,d+10))}function mt(n,o,l,a){if(n.length===0)return[];const r=o.baseSpacing||30,d=o.schemaSpacing||90,c=o.nodeSpacing||20,b=o.width||1200,C=54,M=69,E=n.map(i=>({schema:i,y:ct(i,l,a,r,d,n),width:vt(i),height:i.maintainers?M:C}));return E.sort((i,y)=>i.y-y.y),gt(E,C,c,b)}function gt(n,o,l,a=1200){const r=[];if(n.length===0)return r;const d=80,c=50,b=a-d-c,C=4,M=b/C,E=(h,i)=>{const y=h.id+h.name+h.authors.join("")+h.date;let g=0;for(let w=0;w<y.length;w++)g=(g<<5)-g+y.charCodeAt(w),g=g&g;return g=Math.abs(g*2654435761),g=Math.abs(g*1597334677),g%i-i/2};return n.forEach((h,i)=>{const y=(i+1)%C,g=d+M*y+M/2,w=M*.6,k=E(h.schema,w),P=g+k-h.width/2,R=Math.max(d,Math.min(P,a-c-h.width));r.push({schema:h.schema,x:R,y:h.y+50,width:h.width,height:h.height})}),r}function pt(n){const o=[],l=yt(n);o.push(...l);const a=wt(n);o.push(...a);const r=bt(n,o);return o.push(...r),o}function yt(n){const o=[],l=new Map;for(const a of n)for(const r of a.features){const d=l.get(r);d?d!==a.id&&o.push({from:a.id,to:d,type:"feature",label:r}):l.set(r,a.id)}return o}function wt(n){const o=[],l=new Map;for(const a of n){const r=[...a.authors];a.maintainers&&r.push(...a.maintainers);for(const d of r){const c=l.get(d)||[];for(const b of c)o.push({from:a.id,to:b,type:"author",label:d});l.has(d)||l.set(d,[]),l.get(d).push(a.id)}}return o}function bt(n,o){const l=[],a=new Set;o.forEach(r=>{a.add(`${r.from}-${r.to}`),a.add(`${r.to}-${r.from}`)});for(let r=0;r<n.length;r++)for(let d=r+1;d<n.length;d++){const c=n[r],b=n[d];if(a.has(`${c.id}-${b.id}`)||a.has(`${b.id}-${c.id}`))continue;const C=new Set([...c.authors,...c.maintainers||[]]),M=new Set([...b.authors,...b.maintainers||[]]);if([...C].some(k=>M.has(k)))continue;const h=new Set(c.features),i=new Set(b.features),y=[...h].filter(k=>!i.has(k)),g=[...i].filter(k=>!h.has(k)),w=y.length+g.length;if(y.length<=1&&g.length<=1){let k="ç›¸ä¼¼";w>1?k=`${[...y,...g].join(" å° ")}`:w===1?k=`${y.length>0?y[0]:g[0]} ä¸åŒ`:w===0&&(k="é«˜åº¦ç›¸ä¼¼");const[P,R]=L(c.date)>L(b.date)?[c.id,b.id]:[b.id,c.id];l.push({from:P,to:R,type:"similar",label:k})}}return l}function kt(n){const o=n.filter(c=>c.type==="feature"),l=n.filter(c=>c.type==="author"),a=n.filter(c=>c.type==="similar"),r=new Map,d=new Map;for(const c of o)r.set(c.label,(r.get(c.label)||0)+1);for(const c of l)d.set(c.label,(d.get(c.label)||0)+1);return{total:n.length,featureConnections:o.length,authorConnections:l.length,similarConnections:a.length,byFeature:r,byAuthor:d}}function _t(n,o,l,a,r=.5){const d=(o+a)/2,c=n,b=d-(a-o)*0,C=l,M=d+(a-o)*0;return`M ${n},${o} C ${c},${b} ${C},${M} ${l},${a}`}function je(n,o="center"){switch(o){case"top":return{x:n.x+n.width/2,y:n.y};case"bottom":return{x:n.x+n.width/2,y:n.y+n.height};case"left":return{x:n.x,y:n.y+n.height/2};case"right":return{x:n.x+n.width,y:n.y+n.height/2};case"center":default:return{x:n.x+n.width/2,y:n.y+n.height/2}}}function xt(n,o){const l=o.get(n.from),a=o.get(n.to);if(!l||!a)return null;const r=je(l,"top"),d=je(a,"bottom");return _t(r.x,r.y,d.x,d.y,.3)}function Ct(n,o="light"){return n.type==="feature"?o==="light"?"rgba(99, 102, 241, 0.5)":"rgba(165, 180, 252, 0.5)":n.type==="author"?o==="light"?"rgba(34, 197, 94, 0.5)":"rgba(134, 239, 172, 0.5)":n.type==="similar"?o==="light"?"rgba(71, 85, 105, 0.5)":"rgba(226, 232, 240, 0.5)":"rgba(156, 163, 175, 0.5)"}function St(n,o=!1){return o?3:2}function Mt(n,o){const l=[];for(const a of n){const r=xt(a,o);r&&l.push({connection:a,path:r})}return l}const Yt={key:0,class:"loading-state"},Et={key:1,class:"error-state"},$t={key:2,class:"genealogy-content"},Ft={class:"toolbar-compact"},It={class:"toolbar-header"},Dt={class:"toolbar-stats"},Wt={class:"toolbar-controls"},Tt={class:"toolbar-left"},Nt={class:"dropdown-wrapper"},At={key:0,class:"badge"},Xt={class:"dropdown-header"},Lt=["checked","onChange"],Pt={class:"dropdown-wrapper"},jt={key:0,class:"badge"},Ot={class:"dropdown-header"},zt=["checked","onChange"],Ht={class:"dropdown-wrapper"},qt={key:0,class:"badge"},Rt={class:"dropdown-header"},Vt=["checked","onChange"],Gt={class:"toolbar-right"},Ut={class:"scale-control-inline"},Qt=["title"],Jt={class:"canvas-wrapper"},Kt=["width","height"],Zt={id:"arrow-feature",viewBox:"0 0 10 10",refX:"9",refY:"5",markerWidth:"5",markerHeight:"3",orient:"auto"},Bt=["fill"],en={id:"arrow-author",viewBox:"0 0 10 10",refX:"9",refY:"5",markerWidth:"3",markerHeight:"3",orient:"auto"},tn=["fill"],nn={id:"arrow-similar",viewBox:"0 0 10 10",refX:"9",refY:"5",markerWidth:"3",markerHeight:"3",orient:"auto"},sn=["fill"],on={class:"connections"},an=["onMouseenter","onMouseleave","onClick"],rn=["d","stroke","stroke-width","marker-end","stroke-dasharray"],ln={class:"year-labels"},un=["y2"],cn=["y"],dn={class:"schema-nodes-all"},hn=["transform","onMousedown"],fn=["width","height"],vn={x:10,y:16,class:"node-name","text-anchor":"start","shape-rendering":"crispEdges","text-rendering":"geometricPrecision"},mn={key:0,x:10,y:31,class:"node-author","text-anchor":"start","shape-rendering":"crispEdges","text-rendering":"geometricPrecision"},gn=["y"],pn=["y"],yn={key:0,class:"drag-ghost"},wn=["transform"],bn=["width","height"],kn={key:1,class:"connection-labels"},_n=["onMouseenter","onClick"],xn=["x","y","width","height"],Cn=["x","y"],Sn={key:1,class:"floating-hint"},Mn={key:0,class:"schema-details"},Yn={class:"schema-details-name"},En=["href"],$n={key:0,class:"schema-details-maintainers"},Fn={class:"schema-details-authors"},In={class:"schema-details-date"},Dn={class:"schema-details-features"},Wn={key:1,class:"schema-details-description"},Tn={class:"hint-text"},Nn={key:0},An={key:1},Xn={key:2},Ln=et({__name:"Genealogy",props:{config:{default:()=>({})}},setup(n){const o=n,l={width:840,height:1200,nodeSpacing:10,baseSpacing:15,schemaSpacing:35,emptyYearThreshold:3,emptySegmentSpacing:30,labelInterval:5,reverseTimeline:!1,showDeprecated:!0,highlightFeatures:[]},a=$(()=>({...l,...o.config})),r=_([]),d=_([]),c=_(!0),b=_(null),C=_(0),M=_(0),E=_([]),h=_([]),i=_(null),y=_(null),g=_(null),w=_(null),k=_(null),P=_(0),R=_(0),V=_(null),Q=_(!1),ce=_(new Map),K=_(!1),N=_(null),U=_(.64),j=_([]),O=_([]),z=_([]),ye=_(""),Z=_(!1),B=_(!1),ee=_(!1),A=_([]),we=_(null),J=_(!1),be=()=>{typeof document<"u"&&(J.value=document.documentElement.classList.contains("dark"),console.log("Theme updated:",J.value?"dark":"light",document.documentElement.className))};Ne(()=>{be(),new MutationObserver(be).observe(document.documentElement,{attributes:!0,attributeFilter:["class"]})});const se=$(()=>{let s=r.value;if(a.value.showDeprecated||(s=s.filter(t=>!t.deprecated)),j.value.length>0&&(s=s.filter(t=>j.value.includes(t.id))),O.value.length>0&&(s=s.filter(t=>O.value.some(e=>t.features.includes(e)))),z.value.length>0&&(s=s.filter(t=>z.value.some(e=>t.authors.includes(e)||t.maintainers&&t.maintainers.includes(e)))),ye.value){const t=ye.value.toLowerCase();s=s.filter(e=>{var p;return e.name.toLowerCase().includes(t)||e.authors.some(f=>f.toLowerCase().includes(t))||e.maintainers&&e.maintainers.some(f=>f.toLowerCase().includes(t))||((p=e.description)==null?void 0:p.toLowerCase().includes(t))})}return s}),ke=$(()=>Le(r.value,!1)),ze=$(()=>{if(i.value){const s=new Set([i.value]);return A.value.forEach(t=>{t.from===i.value&&s.add(t.to),t.to===i.value&&s.add(t.from)}),se.value.forEach(t=>s.add(t.id)),s}return new Set(se.value.map(s=>s.id))}),te=$(()=>r.value.length===0?new Map:ut(r.value,a.value.baseSpacing||30,a.value.schemaSpacing||90,a.value.emptyYearThreshold||3,a.value.emptySegmentSpacing||60));function de(s){return ze.value.has(s)}function He(s){return se.value.some(t=>t.id===s)}function qe(s){return de(s.from)&&de(s.to)}const oe=$(()=>ke.value.length===0||C.value===0?[]:mt(ke.value,a.value,C.value,te.value)),_e=$(()=>{if(C.value===0||M.value===0||te.value.size===0)return(a.value.height||1200)*U.value;if(oe.value.length>0)return(Math.max(...oe.value.map(X=>X.y+X.height))+100+150)*U.value;const s=te.value.get(M.value)||0,t=a.value.baseSpacing||30,e=a.value.schemaSpacing||90,p=100,f=150,I=r.value.filter(D=>L(D.date)===M.value).length,F=I>0?t+I*e:t;return(s+F+p+f)*U.value}),he=$(()=>oe.value.map(s=>{const t=ce.value.get(s.schema.id)||0;return{...s,x:s.x+t,y:s.y*U.value}})),Re=$(()=>d.value.map(s=>({...s,y:s.y*U.value}))),fe=$(()=>{const s=new Map;return he.value.forEach(t=>{s.set(t.schema.id,t)}),s}),xe=$(()=>{if(!i.value)return new Set;const s=new Set;return A.value.forEach(t=>{t.from===i.value&&s.add(t.to)}),s}),Ce=$(()=>{if(!i.value)return new Set;const s=new Set;return A.value.forEach(t=>{t.to===i.value&&s.add(t.from)}),s}),Se=$(()=>{if(!i.value)return new Set;const s=new Set;return A.value.forEach(t=>{t.type==="similar"&&(t.from===i.value?s.add(t.to):t.to===i.value&&s.add(t.from))}),s}),Me=$(()=>A.value.length===0?[]:Mt(A.value,fe.value)),Ye=$(()=>Me.value.filter(({connection:s})=>!(we.value&&s.type!==we.value))),Ee=$(()=>{const s=J.value?"dark":"light",t=i.value,e=g.value,p=w.value;return Ye.value.map(({connection:f,path:I})=>{const F=t===f.from,D=t===f.to,x=f.type==="similar"&&(f.from===t||f.to===t),S=F||D||x,X=!e&&!p&&S||(e==null?void 0:e.from)===f.from&&(e==null?void 0:e.to)===f.to||(p==null?void 0:p.from)===f.from&&(p==null?void 0:p.to)===f.to,re=e||p?!((e==null?void 0:e.from)===f.from&&(e==null?void 0:e.to)===f.to||(p==null?void 0:p.from)===f.from&&(p==null?void 0:p.to)===f.to):t&&!S;return{connection:f,path:I,strokeColor:Ct(f,s),strokeWidth:St(f,X),isParent:F,isChild:D,isSimilar:x,isFocused:S&&!e&&!p||X,isDimmed:re}})}),Ve=$(()=>{const s=[];return Ye.value.forEach(({connection:t,path:e})=>{s.push({connection:t,path:e,label:t.label})}),s}),$e=$(()=>{if(!i.value)return[];const t=Ve.value.filter(f=>(f.connection.from===i.value||f.connection.to===i.value)&&f.connection.type!=="author").map(f=>{const I=fe.value.get(f.connection.from),F=fe.value.get(f.connection.to);if(!I||!F)return null;const D=I.x+I.width/2,x=I.y,S=F.x+F.width/2,X=F.y+F.height,me=Ue(f.label)+16;return{connection:f.connection,label:f.label,x:(D+S)/2,y:(x+X)/2,width:me,height:18,lineStartX:D,lineStartY:x,lineEndX:S,lineEndY:X,offset:.5}}).filter(Boolean),e=4,p=10;for(let f=0;f<p;f++){let I=!1;for(let F=0;F<t.length;F++)for(let D=F+1;D<t.length;D++){const x=t[F],S=t[D],X=Math.abs(x.x-S.x),re=Math.abs(x.y-S.y),me=(x.width+S.width)/2+e,Te=(x.height+S.height)/2+e;if(X<me&&re<Te){I=!0;const le=.1;F%2===0?(x.offset=Math.max(.2,x.offset-le),S.offset=Math.min(.8,S.offset+le)):(x.offset=Math.min(.8,x.offset+le),S.offset=Math.max(.2,S.offset-le)),x.x=x.lineStartX+(x.lineEndX-x.lineStartX)*x.offset,x.y=x.lineStartY+(x.lineEndY-x.lineStartY)*x.offset,S.x=S.lineStartX+(S.lineEndX-S.lineStartX)*S.offset,S.y=S.lineStartY+(S.lineEndY-S.lineStartY)*S.offset}}if(!I)break}return t}),ve=$(()=>A.value.length===0?{total:0,featureConnections:0,authorConnections:0,similarConnections:0,byFeature:new Map,byAuthor:new Map}:kt(A.value)),T=$(()=>i.value&&r.value.find(s=>s.id===i.value)||null);async function Fe(){c.value=!0,b.value=null;try{const s=await rt();if(s.length===0)throw new Error("ç„¡æ³•åŠ è¼‰æ•¸æ“š");r.value=s;const t=ft(s);C.value=t.minYear,M.value=t.maxYear,d.value=Pe(s,te.value,a.value.emptyYearThreshold||3,a.value.labelInterval||5),E.value=dt(s),h.value=ht(s);const e=Le(s,!1);A.value=pt(e),console.log("æ•¸æ“šåŠ è¼‰å®Œæˆ:",{ç¸½æ•¸:s.length,å¹´ä»½ç¯„åœ:`${C.value}-${M.value}`,ç‰¹æ€§æ•¸:E.value.length,ä½œè€…æ•¸:h.value.length,é€£æ¥æ•¸:A.value.length,ç‰¹æ€§é€£æ¥:ve.value.featureConnections,ä½œè€…é€£æ¥:ve.value.authorConnections,ç›¸ä¼¼é€£æ¥:ve.value.similarConnections})}catch(s){b.value=s instanceof Error?s.message:"åŠ è¼‰å¤±æ•—",console.error("åŠ è¼‰æ•¸æ“šæ™‚å‡ºéŒ¯:",s)}finally{c.value=!1}}function Ge(s){const t=performance.now();i.value===s?(i.value=null,w.value=null):(i.value=s,w.value=null),ot(()=>{const p=performance.now()-t;console.log(`é—œæ³¨æ¨¡å¼åˆ‡æ›è€—æ™‚: ${p.toFixed(2)}ms`,{é€£æ¥æ•¸:Me.value.length,æ¸²æŸ“ç·©å­˜:Ee.value.length,æ¨™ç±¤æ•¸:$e.value.length,ç¯€é»æ•¸:he.value.length})})}function ae(s){w.value||(g.value=s)}function Ie(s){w.value&&w.value.from===s.from&&w.value.to===s.to?w.value=null:(w.value=s,g.value=null)}function Ue(s){let t=0;for(let e=0;e<s.length;e++){const p=s.charCodeAt(e);p>=19968&&p<=40959||p>=13312&&p<=19903||p>=131072&&p<=173791?t+=12:t+=6.5}return t}function Qe(s){const t=j.value.indexOf(s);t>-1?j.value.splice(t,1):j.value.push(s)}function Je(s){const t=O.value.indexOf(s);t>-1?O.value.splice(t,1):O.value.push(s)}function Ke(s){const t=z.value.indexOf(s);t>-1?z.value.splice(t,1):z.value.push(s)}function Ze(s,t){P.value=s.clientX,R.value=s.clientX,k.value=t,V.value=window.setTimeout(()=>{Q.value=!0,document.body.style.cursor="grabbing"},200)}function De(s){k.value&&(R.value=s.clientX,Q.value&&s.preventDefault())}function We(){if(V.value!==null&&(clearTimeout(V.value),V.value=null),Q.value&&k.value){const s=R.value-P.value,t=ce.value.get(k.value)||0;ce.value.set(k.value,t+s),document.body.style.cursor=""}else k.value&&Ge(k.value);Q.value=!1,k.value=null}function Be(){N.value&&(K.value?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen():N.value.requestFullscreen?N.value.requestFullscreen():N.value.webkitRequestFullscreen?N.value.webkitRequestFullscreen():N.value.mozRequestFullScreen?N.value.mozRequestFullScreen():N.value.msRequestFullscreen&&N.value.msRequestFullscreen())}function G(){K.value=!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}return Ne(()=>{Fe(),document.addEventListener("mousemove",De),document.addEventListener("mouseup",We),document.addEventListener("fullscreenchange",G),document.addEventListener("webkitfullscreenchange",G),document.addEventListener("mozfullscreenchange",G),document.addEventListener("MSFullscreenChange",G)}),tt(()=>{document.removeEventListener("mousemove",De),document.removeEventListener("mouseup",We),document.removeEventListener("fullscreenchange",G),document.removeEventListener("webkitfullscreenchange",G),document.removeEventListener("mozfullscreenchange",G),document.removeEventListener("MSFullscreenChange",G),V.value!==null&&clearTimeout(V.value)}),nt(()=>o.config,()=>{d.value=Pe(r.value,te.value,a.value.emptyYearThreshold||3,a.value.labelInterval||5)},{deep:!0}),(s,t)=>(m(),v("div",{ref_key:"genealogyContainer",ref:N,class:ie(["genealogy-container",{"fullscreen-mode":K.value}])},[c.value?(m(),v("div",Yt,[...t[12]||(t[12]=[u("div",{class:"loading-spinner"},null,-1),u("p",null,"åŠ è¼‰ä¸­...",-1)])])):b.value?(m(),v("div",Et,[u("p",null,Y(b.value),1),u("button",{onClick:Fe,class:"btn btn-sm btn-primary"},"é‡è©¦")])):(m(),v("div",$t,[u("div",Ft,[u("div",It,[t[13]||(t[13]=u("h2",{class:"toolbar-title"},"æ¼¢å­—å­—å½¢è¼¸å…¥æ³•ç¹«çµ¡åœ–",-1)),u("span",Dt," å…± "+Y(se.value.length)+" å€‹è¼¸å…¥æ³• ("+Y(C.value)+"-"+Y(M.value)+") ",1)]),u("div",Wt,[u("div",Tt,[u("div",Nt,[u("button",{onClick:t[0]||(t[0]=e=>Z.value=!Z.value),class:"dropdown-trigger"},[t[14]||(t[14]=ne(" æ–¹æ¡ˆ ",-1)),j.value.length>0?(m(),v("span",At,Y(j.value.length),1)):W("",!0),t[15]||(t[15]=u("span",{class:"arrow"},"â–¼",-1))]),Z.value?(m(),v("div",{key:0,class:"dropdown-menu",onClick:t[2]||(t[2]=ge(()=>{},["stop"]))},[u("div",Xt,[u("button",{onClick:t[1]||(t[1]=e=>j.value=[]),class:"clear-btn"},"æ¸…é™¤")]),(m(!0),v(H,null,q(r.value,e=>(m(),v("label",{key:e.id,class:"dropdown-item"},[u("input",{type:"checkbox",checked:j.value.includes(e.id),onChange:p=>Qe(e.id)},null,40,Lt),u("span",null,Y(e.name),1)]))),128))])):W("",!0)]),u("div",Pt,[u("button",{onClick:t[3]||(t[3]=e=>ee.value=!ee.value),class:"dropdown-trigger"},[t[16]||(t[16]=ne(" ä½œè€… ",-1)),z.value.length>0?(m(),v("span",jt,Y(z.value.length),1)):W("",!0),t[17]||(t[17]=u("span",{class:"arrow"},"â–¼",-1))]),ee.value?(m(),v("div",{key:0,class:"dropdown-menu",onClick:t[5]||(t[5]=ge(()=>{},["stop"]))},[u("div",Ot,[u("button",{onClick:t[4]||(t[4]=e=>z.value=[]),class:"clear-btn"},"æ¸…é™¤")]),(m(!0),v(H,null,q(h.value,e=>(m(),v("label",{key:e,class:"dropdown-item"},[u("input",{type:"checkbox",checked:z.value.includes(e),onChange:p=>Ke(e)},null,40,zt),u("span",null,Y(e),1)]))),128))])):W("",!0)]),u("div",Ht,[u("button",{onClick:t[6]||(t[6]=e=>B.value=!B.value),class:"dropdown-trigger"},[t[18]||(t[18]=ne(" ç‰¹å¾µ ",-1)),O.value.length>0?(m(),v("span",qt,Y(O.value.length),1)):W("",!0),t[19]||(t[19]=u("span",{class:"arrow"},"â–¼",-1))]),B.value?(m(),v("div",{key:0,class:"dropdown-menu",onClick:t[8]||(t[8]=ge(()=>{},["stop"]))},[u("div",Rt,[u("button",{onClick:t[7]||(t[7]=e=>O.value=[]),class:"clear-btn"},"æ¸…é™¤")]),(m(!0),v(H,null,q(E.value,e=>(m(),v("label",{key:e,class:"dropdown-item"},[u("input",{type:"checkbox",checked:O.value.includes(e),onChange:p=>Je(e)},null,40,Vt),u("span",null,Y(e),1)]))),128))])):W("",!0)])]),u("div",Gt,[u("div",Ut,[pe(u("input",{type:"range","onUpdate:modelValue":t[9]||(t[9]=e=>U.value=e),min:"0.25",max:"1.0",step:"0.05",class:"scale-slider-inline"},null,512),[[st,U.value,void 0,{number:!0}]])]),u("button",{onClick:Be,class:"btn-compact",title:K.value?"é€€å‡ºå…¨å± (ESC)":"é€²å…¥å…¨å±"},Y(K.value?"âœ• é€€å‡º":"â›¶"),9,Qt)])])]),Z.value||B.value||ee.value?(m(),v("div",{key:0,class:"dropdown-backdrop",onClick:t[10]||(t[10]=e=>{Z.value=!1,B.value=!1,ee.value=!1})})):W("",!0),u("div",Jt,[(m(),v("svg",{width:a.value.width,height:_e.value,class:"genealogy-svg"},[u("defs",null,[u("marker",Zt,[u("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:J.value?"rgba(165, 180, 252, 0.6)":"rgba(99, 102, 241, 0.6)"},null,8,Bt)]),u("marker",en,[u("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:J.value?"rgba(134, 239, 172, 0.6)":"rgba(34, 197, 94, 0.6)"},null,8,tn)]),u("marker",nn,[u("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:J.value?"rgba(251, 191, 36, 0.8)":"rgba(245, 158, 11, 0.7)"},null,8,sn)])]),u("g",on,[(m(!0),v(H,null,q(Ee.value,(e,p)=>pe((m(),v("g",{key:`${e.connection.from}-${e.connection.to}-${e.connection.type}-${p}`,onMouseenter:f=>i.value&&!e.isDimmed&&ae(e.connection),onMouseleave:f=>i.value&&!e.isDimmed&&ae(null),onClick:f=>i.value&&!e.isDimmed&&Ie(e.connection)},[u("path",{d:e.path,stroke:e.strokeColor,"stroke-width":e.strokeWidth,fill:"none","marker-end":e.connection.type!=="similar"?`url(#arrow-${e.connection.type})`:void 0,"stroke-dasharray":e.connection.type==="similar"?"5, 5":e.connection.type==="author"?"10, 6":"none",class:ie({"connection-line":!0,[`connection-${e.connection.type}`]:!0,"connection-parent":e.isParent,"connection-child":e.isChild,"connection-similar":e.isSimilar,"connection-focused":e.isFocused,"connection-dimmed":e.isDimmed,"connection-interactive":!e.isDimmed})},[u("title",null,Y(e.connection.label),1)],10,rn)],40,an)),[[Ae,qe(e.connection)]])),128))]),u("g",ln,[u("line",{x1:50,y1:50,x2:50,y2:_e.value-50,class:"timeline-axis"},null,8,un),(m(!0),v(H,null,q(Re.value,e=>(m(),v("text",{key:e.year,x:40,y:e.y+54,class:"year-label-text","text-anchor":"end"},Y(e.year),9,cn))),128))]),u("g",dn,[(m(!0),v(H,null,q(he.value,e=>pe((m(),v("g",{key:e.schema.id,transform:`translate(${e.x}, ${e.y})`,onMousedown:p=>Ze(p,e.schema.id),class:ie(["schema-node",{hovered:y.value===e.schema.id,"schema-node-dimmed":i.value&&e.schema.id!==i.value&&!xe.value.has(e.schema.id)&&!Ce.value.has(e.schema.id)&&!Se.value.has(e.schema.id),"schema-node-parent":i.value&&xe.value.has(e.schema.id),"schema-node-child":i.value&&Ce.value.has(e.schema.id),"schema-node-similar":i.value&&Se.value.has(e.schema.id),"schema-node-extended":i.value&&!He(e.schema.id),focused:i.value===e.schema.id,dragging:Q.value&&k.value===e.schema.id}])},[u("rect",{width:e.width,height:e.height,class:"node-bg",rx:"8"},null,8,fn),u("text",vn,Y(e.schema.name),1),e.schema.maintainers?(m(),v("text",mn,Y(e.schema.maintainers.join(" ")),1)):W("",!0),u("text",{x:10,y:e.schema.maintainers?46:31,class:"node-author","text-anchor":"start","shape-rendering":"crispEdges","text-rendering":"geometricPrecision"},Y(e.schema.authors.join(" ")),9,gn),u("text",{x:10,y:e.schema.maintainers?61:46,class:"node-date","text-anchor":"start","shape-rendering":"crispEdges","text-rendering":"geometricPrecision"},Y(Xe(Oe)(e.schema.date)),9,pn)],42,hn)),[[Ae,de(e.schema.id)]])),128))]),Q.value&&k.value?(m(),v("g",yn,[(m(!0),v(H,null,q(oe.value.filter(e=>e.schema.id===k.value),e=>(m(),v("g",{key:"ghost-"+e.schema.id,transform:`translate(${e.x+(R.value-P.value)}, ${e.y})`},[u("rect",{width:e.width,height:e.height,class:"ghost-bg",rx:"8"},null,8,bn)],8,wn))),128))])):W("",!0),i.value?(m(),v("g",kn,[(m(!0),v(H,null,q($e.value,(e,p)=>{var f,I,F,D;return m(),v("g",{key:`label-${p}`,onMouseenter:x=>ae(e.connection),onMouseleave:t[11]||(t[11]=x=>ae(null)),onClick:x=>Ie(e.connection),class:ie(["connection-label-group",{"label-hovered":g.value&&g.value.from===e.connection.from&&g.value.to===e.connection.to,"label-pinned":w.value&&w.value.from===e.connection.from&&w.value.to===e.connection.to,"label-dimmed":(g.value||w.value)&&!(((f=g.value)==null?void 0:f.from)===e.connection.from&&((I=g.value)==null?void 0:I.to)===e.connection.to||((F=w.value)==null?void 0:F.from)===e.connection.from&&((D=w.value)==null?void 0:D.to)===e.connection.to),"label-parent":e.connection.from===i.value&&e.connection.type!=="similar","label-child":e.connection.to===i.value&&e.connection.type!=="similar","label-similar":e.connection.type==="similar"&&(e.connection.from===i.value||e.connection.to===i.value)}])},[u("rect",{x:e.x-e.width/2,y:e.y-e.height/2,width:e.width,height:e.height,class:"connection-label-bg",rx:"4"},null,8,xn),u("text",{x:e.x,y:e.y+4,class:"connection-label","text-anchor":"middle"},Y(e.label),9,Cn)],42,_n)}),128))])):W("",!0)],8,Kt))]),i.value||w.value?(m(),v("div",Sn,[T.value?(m(),v("div",Mn,[u("div",Yn,[ne(Y(T.value.name)+" ",1),T.value.url?(m(),v("a",{key:0,href:T.value.url,target:"_blank",rel:"noopener noreferrer",class:"schema-link-icon",title:"è¨ªå•ç¶²ç«™"},"ğŸ”—",8,En)):W("",!0)]),T.value.maintainers?(m(),v("div",$n,Y(T.value.maintainers.join("ã€"))+" (ä¿®è¨‚ç¶­è­·) ",1)):W("",!0),u("div",Fn,Y(T.value.authors.join("ã€")),1),u("div",In,Y(Xe(it)(T.value.date)),1),u("div",Dn,[(m(!0),v(H,null,q(T.value.features,e=>(m(),v("span",{key:e,class:"feature-tag"},Y(e),1))),128))]),T.value.description?(m(),v("div",Wn,[t[20]||(t[20]=u("span",{class:"description-label"},null,-1)),ne(Y(T.value.description),1)])):W("",!0)])):W("",!0),u("div",Tn,[w.value?(m(),v("span",Nn,"å†æ¬¡é»æ“Šç‰¹å¾µæ¨™ç±¤è§£é™¤é‡˜é¸æ¨¡å¼")):g.value?(m(),v("span",An,"é»æ“Šç‰¹å¾µæ¨™ç±¤é€²å…¥é‡˜é¸æ¨¡å¼")):(m(),v("span",Xn,"å†æ¬¡é»æ“Šæ–¹æ¡ˆå¡ç‰‡è§£é™¤é—œæ³¨æ¨¡å¼"))])])):W("",!0)]))],2))}}),jn=at(Ln,[["__scopeId","data-v-f53bc8a5"]]);export{jn as G};
