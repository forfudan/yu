import{d as ee,v as te,l as ae,ab as se,c as i,o as u,F as G,e as f,k as M,m as t,t as g,n as r,j as p,O as re,C as ne,a as B,a3 as oe,a4 as le,a2 as ie,a0 as ue,G as ce,R as F,_ as de}from"./framework.CUT8mDDq.js";import{A as ve}from"./advancedSchedule.CyVEQGBC.js";const ge={key:0,class:"text-center py-16"},pe={class:"mb-8"},xe={class:"text-xl text-gray-600 dark:text-gray-400 mb-8"},fe={class:"relative"},ye={key:0,class:"text-red-600 dark:text-red-400"},be={key:0,class:"opacity-75 ml-1"},me={key:1,class:"ml-1 text-xs"},he={class:"flex items-center gap-1"},ke={class:"flex items-center gap-1"},we={key:1,class:"text-xs opacity-75"},Ce=ee({__name:"TupaTrain",props:{charCount:{}},setup(H){const K=H,{charCount:A}=K;console.log(`è¼‰å…¥ä¸­å¤æ‹¼éŸ³ç·´ç¿’æœƒè©±ï¼Œè¨“ç·´å­—æ•¸: ${A}`);const c=new ve(`tupa_train_${A}`),b=p(0),T=p(),m=p(""),d=p(!1),v=p(!0),j=p(0),C=p(!1),E=p(0),S=ce([]),s=p(typeof window<"u"?window.innerWidth:1024),W=()=>{s.value=window.innerWidth},P=M(()=>{const a=s.value<768,e=s.value<1024;return a?"text-6xl":e?"text-8xl":"text-9xl"}),o=M(()=>S.value[b.value]||null),h=M(()=>{E.value;const a=c.getProgressStats();return{current:a.practiced,total:a.total,mastered:a.mastered,percentage:a.percentage.toFixed(1)}}),U=M(()=>h.value.percentage),O=M(()=>(E.value,c.isCompleted())),J=()=>{C.value=!0},N=()=>{c.reset(),C.value=!1,S.value.length>0&&c.initializeWithGroupCount(S.value.length),E.value++,I(),console.log("è¨“ç·´å·²é‡ç½®")},R=()=>{C.value=!1},V=a=>{if(C.value){a.key==="Enter"?N():a.key==="Escape"&&R();return}a.key==="Escape"&&!d.value&&($(),a.preventDefault())};te(m,a=>{var l;if(console.log("è¼¸å…¥å€¼è®ŠåŒ–:",a),!o.value){console.log("è·³éè™•ç†ï¼šcurrentEntry ç‚ºç©º");return}const e=a.trim().toLowerCase();if(!e){console.log("è·³éè™•ç†ï¼šè¼¸å…¥ç‚ºç©º");return}const n=o.value.pinyins.length>0&&o.value.pinyins[0].pinyin.toLowerCase()===e;console.log("è¼¸å…¥åŒ¹é…æª¢æŸ¥:",e,"æœŸæœ›ç¬¬ä¸€å€‹æ‹¼éŸ³:",(l=o.value.pinyins[0])==null?void 0:l.pinyin,"åŒ¹é…çµæœ:",n),n&&(console.log("è¼¸å…¥æ­£ç¢ºï¼Œèª¿ç”¨ handleCorrectAnswer"),q())});const Q=a=>{const n=a.target.value.trim().toLowerCase();if(!o.value||!n)return;o.value.pinyins.length>0&&o.value.pinyins[0].pinyin.toLowerCase()===n&&q()},X=a=>{if(a.key==="Enter"){const e=m.value.trim().toLowerCase();e&&o.value&&(o.value.pinyins.length>0&&o.value.pinyins[0].pinyin.toLowerCase()===e?q():$())}},q=()=>{if(console.log("handleCorrectAnswer() è¢«èª¿ç”¨"),!o.value){console.log("currentEntry ç‚ºç©ºï¼Œè¿”å›");return}v.value=!0,c.recordSuccess(b.value),console.log("è¨˜éŒ„æˆåŠŸï¼Œç´¢å¼•:",b.value),E.value++,console.log("æº–å‚™é€²å…¥ä¸‹ä¸€å­—"),I()},$=()=>{o.value&&(v.value=!1,j.value++,d.value=!0,c.recordFailure(b.value),E.value++,m.value="",F(()=>{var a;(a=T.value)==null||a.focus()}))},I=()=>{console.log("nextChar() è¢«èª¿ç”¨");const a=c.getNextIndex();if(console.log("ç²å–åˆ°çš„ä¸‹ä¸€å€‹å­—ç¬¦ç´¢å¼•:",a),a!==null)b.value=a,console.log("è¨­ç½® currentIndex ç‚º:",a);else{console.log("æ‰€æœ‰å­—ç¬¦å·²å®Œæˆï¼Œåœæ­¢ç·´ç¿’");return}v.value=!0,j.value=0,m.value="",c.isFirstTime(b.value)?(d.value=!0,console.log("ç¬¬ä¸€æ¬¡è¦‹åˆ°æ­¤å­—ç¬¦ï¼Œé¡¯ç¤ºç­”æ¡ˆ")):(d.value=!1,console.log("ä¸æ˜¯ç¬¬ä¸€æ¬¡è¦‹åˆ°æ­¤å­—ç¬¦ï¼Œç­‰å¾…è¼¸å…¥")),F(()=>{var e;(e=T.value)==null||e.focus(),console.log("èšç„¦åˆ°è¼¸å…¥æ¡†")})},Y=async()=>{try{console.log("é–‹å§‹è¼‰å…¥ä¸­å¤æ‹¼éŸ³è³‡æ–™...");const a=await fetch("/mabiao-tupa.txt");if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const e=await a.text();console.log("æˆåŠŸç²å–æ•¸æ“šï¼Œæ–‡æœ¬é•·åº¦:",e.length);const n=e.trim().split(`
`);console.log("åˆ†å‰²å¾Œè¡Œæ•¸:",n.length);const l=new Map;for(const w of n){const y=w.split("	");if(y.length<2)continue;const x=y[0],_=y[1],z=y[2];let L;z&&z.includes("%")?L=parseFloat(z.replace("%","")):L=100,l.has(x)||l.set(x,{char:x,pinyins:[]}),l.get(x).pinyins.push({pinyin:_,freq:L})}console.log("è§£æå¾—åˆ°çš„å­—ç¬¦æ•¸:",l.size);const k=[],D=new Set;for(const w of n){const y=w.split("	");if(y.length<2)continue;const x=y[0];if(D.has(x))continue;const _=l.get(x);if(_&&(_.pinyins.sort((z,L)=>(L.freq||0)-(z.freq||0)),k.push(_),D.add(x),k.length>=A))break}S.value=k,console.log("æœ€çµ‚å­—ç¬¦æ•¸çµ„é•·åº¦:",k.length),c.initializeWithGroupCount(k.length),console.log("èª¿åº¦ç³»çµ±åˆå§‹åŒ–å®Œæˆ"),console.log(`è¼‰å…¥äº† ${k.length} å€‹å­—ç¬¦çš„ä¸­å¤æ‹¼éŸ³è³‡æ–™`),I(),console.log("èª¿ç”¨ nextChar() å®Œæˆ"),F(()=>{var w;(w=T.value)==null||w.focus(),console.log("è¼¸å…¥æ¡†èšç„¦å®Œæˆ")})}catch(a){console.error("è¼‰å…¥ä¸­å¤æ‹¼éŸ³è³‡æ–™å¤±æ•—:",a)}},Z=()=>{c.reset(),I()};return ae(()=>{typeof window<"u"&&window.addEventListener("resize",W),document.addEventListener("keydown",V),Y()}),se(()=>{typeof window<"u"&&window.removeEventListener("resize",W),document.removeEventListener("keydown",V)}),(a,e)=>(u(),i(G,null,[O.value?(u(),i("div",ge,[t("div",pe,[e[2]||(e[2]=t("div",{class:"text-6xl mb-4"},"ğŸ‰",-1)),e[3]||(e[3]=t("h2",{class:"text-4xl font-bold mb-2"},"æ­å–œä½ å®Œæˆç·´ç¿’ï¼",-1)),t("p",xe," ä½ å·²ç¶“å®Œæˆäº† "+g(h.value.total)+" å€‹å­—ç¬¦çš„ä¸­å¤æ‹¼éŸ³ç·´ç¿’ã€‚ æ„Ÿè¬ä½ çš„åŠªåŠ›å’Œå …æŒï¼Œç‚ºä¸­è¯æ–‡æ˜å’Œæ¼¢å­—çš„å‚³æ‰¿åˆå¢æ·»äº†ä¸€ä»½åŠ›é‡ï¼ ",1)]),t("div",{class:"space-y-4"},[t("button",{onClick:Z,class:"px-8 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 font-medium"}," æƒ³è¦å†è¨“ç·´ä¸€è¼ªå—ï¼Ÿ "),e[4]||(e[4]=t("div",{class:"text-sm text-gray-500 dark:text-gray-400"}," ç¹¼çºŒç·´ç¿’ä»¥éå›ºè¨˜æ†¶ ",-1))])])):o.value?(u(),i("div",{key:1,class:r(["mx-auto p-6 space-y-6",s.value<768?"max-w-sm p-3 space-y-3":"max-w-2xl"])},[t("div",fe,[t("div",{class:r(["text-center text-gray-600 dark:text-gray-400",s.value<768?"text-xs":"text-sm"])},[t("div",{class:r(["flex justify-between items-center",s.value<768?"mb-1":"mb-2"])},[t("span",null,"å·²ç·´ç¿’: "+g(h.value.current)+" / "+g(h.value.total)+" ("+g(h.value.percentage)+"%) | å·²æŒæ¡: "+g(h.value.mastered),1),j.value>0?(u(),i("span",ye,"éŒ¯èª¤æ¬¡æ•¸: "+g(j.value),1)):f("",!0)],2),t("div",{class:r(["w-full bg-gray-200 dark:bg-gray-700 rounded-full",s.value<768?"h-1.5":"h-2"])},[t("div",{class:r(["bg-blue-500 dark:bg-blue-400 rounded-full transition-all duration-300",s.value<768?"h-1.5":"h-2"]),style:re(`width: ${U.value}%`)},null,6)],2)],2)]),t("div",{class:r(["w-full shadow-lg rounded-2xl transition-all duration-300 transform relative",{"bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800":!v.value,"bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800":v.value},"border-2 hover:shadow-xl"])},[t("div",{class:r(["absolute flex gap-2 z-10",s.value<768?"bottom-2 right-2":"bottom-4 right-4"])},[t("button",{onClick:J,class:r(["rounded-full bg-red-500 hover:bg-red-600 text-white font-medium transition-all duration-200 flex items-center justify-center shadow-md",s.value<768?"w-6 h-6 text-xs":"w-8 h-8 text-xs"]),title:"é‡æ–°é–‹å§‹è¨“ç·´"},[(u(),i("svg",{class:r(s.value<768?"w-2 h-2":"w-3 h-3"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...e[5]||(e[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))],2)],2),t("div",{class:r(["text-center",s.value<768?"py-4":"py-12"])},[t("div",{class:r(["flex justify-center items-center mb-4",s.value<768?"mb-4":"mb-12"])},[t("div",{class:r(["zigen-font transform transition-all duration-300",s.value<768?"mb-1":"mb-4",P.value,{"text-red-500 dark:text-red-400":!v.value,"text-blue-700 dark:text-blue-300":v.value}])},g(o.value.char),3)],2),d.value?(u(),i("div",{key:0,class:r(["flex flex-wrap justify-center gap-2 mb-4",s.value<768?"mb-2":"mb-4"])},[(u(!0),i(G,null,ne(o.value.pinyins,(n,l)=>(u(),i("span",{key:l,class:r(["rounded font-mono",s.value<768?"text-xs px-1 py-0.5":"text-sm px-2 py-1",l===0?"bg-blue-100 dark:bg-blue-800 text-blue-800 dark:text-blue-200 font-bold border-2 border-blue-300 dark:border-blue-600":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400"])},[B(g(n.pinyin)+" ",1),n.freq?(u(),i("span",be,"("+g(n.freq)+"%)",1)):f("",!0),l===0?(u(),i("span",me,"âœ“")):f("",!0)],2))),128))],2)):f("",!0)],2),t("div",{class:r(["flex justify-center",s.value<768?"pb-3":"pb-8"])},[oe(t("input",{ref_key:"inputElement",ref:T,"onUpdate:modelValue":e[0]||(e[0]=n=>m.value=n),type:"text",placeholder:"æ‹¼éŸ³",onInput:Q,onKeydown:X,class:r(["text-center border-2 rounded-xl font-mono","transition-all duration-300 focus:outline-none focus:ring-4",s.value<768?"px-3 py-2 text-lg w-32":"px-6 py-4 text-2xl w-48",{"border-red-300 focus:border-red-500 focus:ring-red-200 bg-red-50 dark:border-red-700 dark:focus:border-red-500 dark:focus:ring-red-900/50 dark:bg-red-900/20 dark:text-white":!v.value,"border-blue-300 focus:border-blue-500 focus:ring-blue-200 bg-white dark:border-blue-700 dark:focus:border-blue-500 dark:focus:ring-blue-900/50 dark:bg-gray-800 dark:text-white":v.value}])},null,34),[[le,m.value]])],2),t("div",{class:r(["text-center transition-all duration-300",s.value<768?"pb-3":"pb-8",{"opacity-0 transform translate-y-2":!d.value,"opacity-100":d.value}])},[t("div",{class:r(["inline-block bg-gray-100 dark:bg-gray-800 rounded-lg",s.value<768?"px-2 py-1":"px-4 py-2"])},[t("span",{class:r(["text-blue-600 dark:text-blue-400 font-medium",s.value<768?"text-sm":""])},"è¼¸å…¥ä¸»è¦æ‹¼éŸ³ï¼ˆå¸¶âœ“æ¨™è¨˜çš„ï¼‰",2)],2)],2)],2),t("div",{class:r(["text-center text-gray-500 dark:text-gray-400 space-y-1",s.value<768?"text-xs":"text-sm"])},[d.value?f("",!0):(u(),i("div",{key:0,class:r(["flex items-center justify-center",s.value<768?"gap-2 flex-col":"gap-4"])},[t("span",he,[t("kbd",{class:r(["bg-gray-100 dark:bg-gray-800 dark:text-gray-300 rounded",s.value<768?"px-1 py-0.5 text-xs":"px-2 py-1 text-xs"])},"è¼¸å…¥",2),e[6]||(e[6]=B(" ä¸»è¦æ‹¼éŸ³ ",-1))]),t("span",ke,[t("kbd",{class:r(["bg-gray-100 dark:bg-gray-800 dark:text-gray-300 rounded",s.value<768?"px-1 py-0.5 text-xs":"px-2 py-1 text-xs"])},"Esc",2),e[7]||(e[7]=B(" é¡¯ç¤ºç­”æ¡ˆ ",-1))])],2)),d.value?f("",!0):(u(),i("div",we," è«‹è¼¸å…¥é »ç‡æœ€é«˜çš„æ‹¼éŸ³ï¼ˆé€šå¸¸æ˜¯ç¬¬ä¸€å€‹ï¼‰ "))],2)],2)):f("",!0),C.value?(u(),i("div",{key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:R},[t("div",{class:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm mx-4 shadow-xl",onClick:e[1]||(e[1]=ue(()=>{},["stop"]))},[e[8]||(e[8]=ie('<div class="flex items-center gap-3 mb-4" data-v-6243394c><div class="w-10 h-10 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center" data-v-6243394c><svg class="w-6 h-6 text-orange-600 dark:text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-6243394c><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z" data-v-6243394c></path></svg></div><div data-v-6243394c><h3 class="text-lg font-medium text-gray-900 dark:text-gray-100" data-v-6243394c>ç¢ºèªé‡ç½®</h3><p class="text-sm text-gray-600 dark:text-gray-400" data-v-6243394c>æ‚¨ç¢ºå®šè¦é‡æ–°é–‹å§‹è¨“ç·´å—ï¼Ÿ</p></div></div><p class="text-sm text-gray-600 dark:text-gray-400 mb-6" data-v-6243394c> é€™å°‡æ¸…é™¤ç•¶å‰çš„å­¸ç¿’é€²åº¦å’Œçµ±è¨ˆæ•¸æ“šï¼Œç„¡æ³•æ¢å¾©ã€‚ </p>',2)),t("div",{class:"flex gap-3 justify-end"},[t("button",{onClick:R,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors"}," å–æ¶ˆ "),t("button",{onClick:N,class:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors"}," ç¢ºèªé‡ç½® ")])])])):f("",!0)],64))}}),ze=de(Ce,[["__scopeId","data-v-6243394c"]]);export{ze as T};
