import{d as b,E as r,k as C,v as h,l as I,c,o as i,m as o,e as k,b as V,a3 as $,a4 as E,a as L,t as x}from"./framework.D5VGNaZP.js";import{_ as S}from"./Search.vue_vue_type_script_setup_true_lang.BNwft3ZV.js";import{f as T}from"./share.D5aqWrzv.js";import{C as F}from"./ChaiDataLoader.DswD24L6.js";const N={class:"input input-bordered bg-gray-100 dark:bg-slate-800 flex items-center gap-2 mt-2"},Z={key:0,class:"text-gray-600 text-center py-4"},j={key:1,class:"alert alert-error mt-2"},O={key:3,class:"opacity-40 text-center p-9 tracking-widest"},P={key:4,class:"text-gray-500 text-center py-4"},H=b({__name:"OptimizedFetchSearch",props:{chaifenUrl:{},zigenUrl:{},supplement:{type:Boolean},ming:{type:Boolean},modelValue:{}},emits:["update:modelValue"],setup(M,{emit:_}){const l=M,z=_,m=r(),p=r(),n=r(!1),s=r(!1),t=r(l.modelValue||""),d=r(null),y=["å°æ¨“ä¸€å¤œè½æ˜¥é›¨ã€€æ·±å··æ˜Žæœè³£æèŠ±","ä¼‘å°æ•…äººæ€æ•…åœ‹ã€€ä¸”å°‡æ–°ç«è©¦æ–°èŒ¶","ä¸‰ååŠŸåå¡µèˆ‡åœŸã€€å…«åƒé‡Œè·¯é›²å’Œæœˆ","è½èŠ±äººç¨ç«‹ã€€å¾®é›¨ç‡•é›™é£›","çŽ²ç“éª°å­å®‰ç´…è±†ã€€å…¥éª¨ç›¸æ€çŸ¥ä¸çŸ¥","å…©æƒ…è‹¥æ˜¯ä¹…é•·æ™‚ã€€åˆè±ˆåœ¨æœæœæš®æš®","èº«ç„¡å½©é³³é›™é£›ç¿¼ã€€å¿ƒæœ‰éˆçŠ€ä¸€é»žé€š","è‡ªåœ¨é£›èŠ±è¼•ä¼¼å¤¢ã€€ç„¡é‚Šçµ²é›¨ç´°å¦‚æ„","é†‰å¾Œä¸çŸ¥å¤©åœ¨æ°´ã€€æ»¿èˆ¹æ¸…å¤¢å£“æ˜Ÿæ²³","æ±é¢¨å¤œæ”¾èŠ±åƒæ¨¹ã€€æ›´å¹è½ã€€æ˜Ÿå¦‚é›¨","é³³è•­è²å‹•ã€€çŽ‰å£¸å…‰è½‰ã€€ä¸€å¤œé­šé¾èˆž","çˆ²å›æŒé…’å‹¸æ–œé™½ã€€ä¸”å‘èŠ±é–“ç•™æ™šç…§","ç¶ æ¥Šç…™å¤–æ›‰å¯’è¼•ã€€ç´…ææžé ­æ˜¥æ„é¬§","åŸŽä¸­æ¡ƒæŽæ„é¢¨é›¨ã€€æ˜¥åœ¨æºªé ­è–ºèœèŠ±","æœªæ˜¯ç§‹å…‰å¥‡ç»ã€€çœ‹åäº”åå…­","ç„¡å¯å¥ˆä½•èŠ±è½åŽ»ã€€ä¼¼æ›¾ç›¸è­˜ç‡•æ­¸ä¾†","ä½†é¡˜äººé•·ä¹…ã€€åƒé‡Œå…±å¬‹å¨Ÿ","å¤§æ±Ÿæ±åŽ»ã€€æµªæ·˜ç›¡åƒå¤é¢¨æµäººç‰©","æ˜Žæœˆå¹¾æ™‚æœ‰ã€€æŠŠé…’å•é’å¤©","ä¸€è“‘ç…™é›¨ä»»å¹³ç”Ÿã€€ä¹Ÿç„¡é¢¨é›¨ä¹Ÿç„¡æ™´","ç¸±è±†è”»è©žå·¥ã€€é’æ¨“å¤¢å¥½ã€€é›£è³¦æ·±æƒ…","è¡£å¸¶æ¼¸å¯¬çµ‚ä¸æ‚”ã€€ç‚ºä¼Šæ¶ˆå¾—äººæ†”æ‚´"],D=C(()=>{const a=Math.floor(Math.random()*y.length);return y[a]});h(()=>l.modelValue,a=>{a!==void 0&&a!==t.value&&(t.value=a,a.trim().length>0&&!s.value&&v())},{immediate:!0}),h(t,a=>{z("update:modelValue",a),a.trim().length>0&&!s.value&&v()}),h([s,t],([a,e])=>{a&&e&&e.trim().length>0&&console.log(`ðŸ” Data loaded, ready to search for: "${e}"`)});const B=F.getInstance(l.chaifenUrl);async function v(){if(s.value||n.value)return;n.value=!0,d.value=null;const a=performance.now();try{const[e,u]=await Promise.all([B.loadData(),T(l.zigenUrl)]),g=new Map;for(const[w,f]of Object.entries(e))g.set(w,{char:w,division:f.d||"",division_tw:f.dt||"",region:f.r||""});m.value=g,p.value=u,s.value=!0;const U=performance.now()-a;console.log(`ðŸš€ Search data loaded in ${U.toFixed(2)}ms`),console.log(`ðŸ“¦ Characters: ${g.size}`),console.log(`ðŸ“ Source: ${l.chaifenUrl}`)}catch(e){console.error("Failed to load search data:",e),d.value=e instanceof Error?e.message:"Unknown error"}finally{n.value=!1}}return I(()=>{t.value.trim().length>0&&v()}),(a,e)=>(i(),c("div",null,[o("label",N,[$(o("input",{"onUpdate:modelValue":e[0]||(e[0]=u=>t.value=u),type:"text",class:"grow",placeholder:"è¼¸å…¥æ¼¢å­—æŸ¥è©¢æ‹†åˆ†å’Œç·¨ç¢¼"},null,512),[[E,t.value]]),e[2]||(e[2]=o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"h-4 w-4 opacity-70"},[o("path",{"fill-rule":"evenodd",d:"M9.965 11.026a5 5 0 1 1 1.06-1.06l2.755 2.754a.75.75 0 1 1-1.06 1.06l-2.755-2.754ZM10.5 7a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Z","clip-rule":"evenodd"})],-1))]),n.value?(i(),c("div",Z,[...e[3]||(e[3]=[o("div",{class:"loading loading-spinner loading-sm mr-2"},null,-1),L(" æ­£åœ¨åŠ è½½æ‹†åˆ†æ•°æ®â€¦â€¦ ",-1)])])):d.value?(i(),c("div",j,[e[4]||(e[4]=o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),o("span",null,"åŠ è½½å¤±è´¥ï¼š"+x(d.value),1)])):k("",!0),s.value&&m.value&&p.value?(i(),V(S,{key:2,chaifenMap:m.value,zigenMap:p.value,supplement:l.supplement,ming:l.ming||!1,userInput:t.value,"onUpdate:userInput":e[1]||(e[1]=u=>t.value=u)},null,8,["chaifenMap","zigenMap","supplement","ming","userInput"])):!t.value.trim()&&!n.value&&!d.value?(i(),c("div",O,x(D.value),1)):t.value.trim().length>0&&!n.value?(i(),c("div",P," å¼€å§‹è¾“å…¥ä»¥æŸ¥çœ‹æ‹†åˆ†â€¦â€¦ ")):k("",!0)]))}});export{H as _};
