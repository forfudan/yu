import{d as ze,l as be,y as Ee,v as ke,o as s,c as o,m as a,e as b,n as _,t as h,F as R,C as V,O as $e,a0 as we,k as O,j as S,a7 as Le,_ as Te}from"./framework.72Ik0KeM.js";import{a as Ae,C as fe}from"./share.Dv-cn20s.js";import{h as Ze}from"./html2canvas-pro.esm.C4LuxvEu.js";class Ce{static generateFileName(d="æœªå‘½åæ–¹æ¡ˆ",L=!1){const $=new Date().toISOString().split("T")[0].replace(/-/g,"");return`${d}è¼¸å…¥æ³•${L?"å­—æ ¹è¡¨":"å­—æ ¹åœ–"}${$}.png`}static addTemporaryWatermark(d,L="å®‡æµ©ç³»åˆ—è¼¸å…¥æ³• Â· å®˜ç¶²: shurufa.app Â· QQ è¨è«–ç¾¤: 170510762"){const $=document.createElement("div");return $.className="zigen-export-watermark",$.style.cssText=`
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            text-align: center;
            margin-top: 16px;
            font-size: 0.9rem;
            color: #4f46e5;
            font-weight: 500;
            border: 1px solid #d1d5db;
            font-family: 'Noto Serif SC', serif;
            backdrop-filter: blur(4px);
        `,$.textContent=L,d.appendChild($),$}static removeTemporaryWatermark(d){d&&d.parentNode&&d.parentNode.removeChild(d)}static async exportZigenMapToPNG(d,L="æœªå‘½åæ–¹æ¡ˆ",$=!1,Q={}){const{copyToClipboard:oe=!0,download:Y=!0,scale:ne=2,addWatermark:M=!0,customFooter:k}=Q,T="#ffffff";let w=null;if(M){const X=k||"å®‡æµ©ç³»åˆ—è¼¸å…¥æ³• Â· å®˜ç¶²: shurufa.app Â· QQ è¨è«–ç¾¤: 170510762";w=this.addTemporaryWatermark(d,X)}let z,A=[],N,J=[],P=[],W=null,se=[];try{document.querySelectorAll(".dark").forEach(f=>{const E=f.classList.contains("dark");se.push({element:f,hadDarkClass:E}),E&&f.classList.remove("dark")}),z=d.querySelectorAll(".layout-toggle-btn, .export-btn"),z.forEach((f,E)=>{const m=f;A[E]=m.style.display,m.style.display="none"}),N=d.querySelectorAll(".text-sm.text-gray-500, .text-xs.text-gray-400"),N.forEach((f,E)=>{var j,D,g,v,C;const m=f;((j=m.textContent)!=null&&j.includes("é»æ“Šå­—æ ¹å¯æŸ¥çœ‹ä¾‹å­—")||(D=m.textContent)!=null&&D.includes("åˆ‡æ›åœ–è¡¨å½¢æ…‹")||(g=m.textContent)!=null&&g.includes("æŒ‰éµæ’åº")||(v=m.textContent)!=null&&v.includes("ç·¨ç¢¼é•·åº¦")||(C=m.textContent)!=null&&C.includes("é¡¯ç¤ºæ¨¡å¼"))&&(J[E]=m.style.display,m.style.display="none")}),W=document.createElement("div"),W.className="export-title",W.style.cssText=`
                text-align: center;
                font-size: 1.5rem;
                font-weight: bold;
                margin-bottom: 1.5rem;
                color: #5400a2ff;
                font-family: 'Noto Serif SC', serif;
            `;const le=d.querySelector(".desktop-list-layout")!==null||d.querySelector(".mobile-key-row")!==null,pe=le?"å­—æ ¹è¡¨":"å­—æ ¹åœ–";W.textContent=`${L}è¼¸å…¥æ³•${pe}`,d.insertBefore(W,d.firstChild),P.push({element:d,originalStyle:d.style.cssText}),d.style.cssText+=`
                min-width: 1028px !important;    /* å­—æ ¹åœ–çš„æœ€å°å¯¬åº¦ */
                width: auto !important;          
                overflow: visible !important;    
                box-sizing: border-box !important; 
            `;const Z=d.querySelector(".keyboard-layout");Z&&(P.push({element:Z,originalStyle:Z.style.cssText}),Z.style.cssText+=`
                    min-width: 1028px !important;    
                    width: auto !important;          
                    overflow: visible !important;    
                    box-sizing: border-box !important; 
                `,Z.querySelectorAll(".keyboard-key").forEach(g=>{const v=g;P.push({element:v,originalStyle:v.style.cssText}),v.style.cssText+=`
                        width: 96px !important;          /* æŒ‰éµå¡ç‰‡å›ºå®šå¯¬åº¦ */
                        flex: 0 0 96px !important;       /* å›ºå®šå½ˆæ€§ä½ˆå±€ */
                    `}),Z.querySelectorAll(".zigen-list").forEach(g=>{const v=g;P.push({element:v,originalStyle:v.style.cssText}),v.style.cssText+=`
                        grid-template-columns: repeat(auto-fill, minmax(16px, max-content)) !important; /* å­—æ ¹æœ€å°å¯¬åº¦ */
                    `}),Z.querySelectorAll(".zigen-code").forEach(g=>{const v=g;P.push({element:v,originalStyle:v.style.cssText}),v.style.cssText+=`
                        margin-top: 1px !important;
                        padding-top: 1px !important;
                        min-height: 8px !important;
                        line-height: 1.0 !important;
                    `}),Z.querySelectorAll(".zigen-item").forEach(g=>{const v=g;P.push({element:v,originalStyle:v.style.cssText}),v.style.cssText+=`
                        gap: 1px !important;
                        padding: 1px !important;
                    `;const C=g.querySelector(".zigen-code");C&&(P.push({element:C,originalStyle:C.style.cssText}),C.style.cssText+=`
                            margin-top: 1px !important;
                            min-height: 2px !important;
                        `)}),Z.querySelectorAll(".keyboard-key").forEach(g=>{var C,ae;const v=(ae=(C=g.querySelector(".key-label"))==null?void 0:C.textContent)==null?void 0:ae.toLowerCase();if(["z",";",",",".","/"].includes(v||"")){const ee=g.querySelector(".no-zigen-text");ee&&(P.push({element:ee,originalStyle:ee.style.cssText}),ee.style.cssText=`
                                display: flex !important;
                                flex-direction: column !important;
                                align-items: center !important;
                                justify-content: center !important;
                                text-align: center !important;
                                font-size: 0.7rem !important;
                                height: 100% !important;
                                line-height: 1.3 !important;
                                padding: 0.2rem !important;
                            `,ee.querySelectorAll("div").forEach(re=>{const ce=re;ce.style.cssText=`
                                    writing-mode: horizontal-tb !important;
                                    text-orientation: mixed !important;
                                    white-space: nowrap !important;
                                    margin: 0.1rem 0 !important;
                                    text-align: center !important;
                                    font-size: 0.65rem !important;
                                `}))}})),await new Promise(f=>setTimeout(f,500));const q=d.getBoundingClientRect(),y=Math.max(q.width,d.scrollWidth,1028),K=Math.max(q.height,d.scrollHeight),F=await Ze(d,{backgroundColor:T,scale:ne,useCORS:!0,allowTaint:!1,logging:!0,width:y,height:K,windowWidth:y,windowHeight:K,scrollX:0,scrollY:0,x:0,y:0,ignoreElements:f=>f.classList.contains("export-btn")||f.classList.contains("layout-toggle-btn")||f.classList.contains("pinned-popup"),foreignObjectRendering:!1,removeContainer:!1,imageTimeout:15e3});this.restoreAllChanges(z,A,N,J,P,W,se);const B=F.toDataURL("image/png",1),H=this.generateFileName(L,le);if(oe&&this.isClipboardSupported())try{const f=await new Promise(E=>{F.toBlob(m=>{m&&E(m)},"image/png",1)});return await navigator.clipboard.write([new ClipboardItem({"image/png":f})]),console.log("å­—æ ¹åœ–å·²è¤‡è£½åˆ°å‰ªè²¼æ¿"),{success:!0,message:"å­—æ ¹åœ–å·²è¤‡è£½åˆ°å‰ªè²¼æ¿ä¸¦ä¸‹è¼‰",dataUrl:B,filename:H}}catch(f){console.warn("è¤‡è£½åˆ°å‰ªè²¼æ¿å¤±æ•—ï¼Œå°‡åƒ…é€²è¡Œä¸‹è¼‰:",f)}if(Y){const f=document.createElement("a");f.download=H,f.href=B,f.style.display="none",document.body.appendChild(f),f.click(),document.body.removeChild(f),console.log("å­—æ ¹åœ–å·²ä¸‹è¼‰:",H)}return{success:!0,message:"å­—æ ¹åœ–å·²ä¸‹è¼‰",dataUrl:B,filename:H}}catch(X){return console.error("å°å‡ºå­—æ ¹åœ–å¤±æ•—:",X),this.restoreAllChanges(z,A,N,J,P,W,se),{success:!1,message:`å°å‡ºå¤±æ•—: ${X instanceof Error?X.message:"æœªçŸ¥éŒ¯èª¤"}`,dataUrl:"",filename:""}}finally{w&&this.removeTemporaryWatermark(w)}}static restoreAllChanges(d,L,$,Q,oe,Y,ne){ne.forEach(({element:M,hadDarkClass:k})=>{k&&M.classList.add("dark")}),d.forEach((M,k)=>{const T=M;T.style.display=L[k]}),$.forEach((M,k)=>{const T=M;Q[k]!==void 0&&(T.style.display=Q[k])}),Y&&Y.parentNode&&Y.remove(),oe.forEach(({element:M,originalStyle:k})=>{M.style.cssText=k,M.querySelectorAll("div").forEach(w=>{const z=w;z.style.cssText=""})})}static isClipboardSupported(){return typeof navigator<"u"&&"clipboard"in navigator&&"write"in navigator.clipboard}static getSchemeDisplayName(d){return{joy:"å¿é›²",light:"å…‰è¯",star:"æ˜Ÿé™³",ming:"æ—¥æœˆ",ling:"éˆæ˜",wafel:"å‰æ—¦é¤…",tianma:"å¤©ç¢¼"}[d]||d}}const De={class:"zigen-map-container"},Me={key:0,class:"flex justify-center items-center py-8"},Ne={key:1,class:"flex justify-between items-center mb-4 px-5"},Pe={key:0,class:"flex items-center space-x-4"},qe={class:"flex items-center space-x-2"},Ke=["disabled","title"],Be={key:0},Ue={key:1},We={class:"flex items-center space-x-2"},je=["title"],Re={key:0},Ve={key:1},Fe={key:0,class:"flex items-center space-x-2"},He=["title"],Ie={key:0},Oe={key:1},Qe={key:1,class:"flex items-center space-x-2"},Xe=["title"],Ge={key:0},Ye={key:1},Je={class:"flex items-center space-x-2"},et=["title"],tt={key:0},st={key:1},ot={key:1,class:"flex items-center space-x-2"},nt=["disabled","title"],lt={key:0},at={key:1},it=["title"],rt={key:0},ct={key:1},ut=["title"],dt={key:0},pt={key:1},vt={key:2,class:"mt-2 text-center"},ft={key:2,class:"keyboard-layout"},mt={class:"key-label"},gt=["onClick"],ht={class:"zigen-code"},yt={key:0,class:"more-indicator"},xt={key:1,class:"text-xs text-gray-400 no-zigen-text"},_t={key:0,class:"vertical-text zigen-font"},bt={key:0},kt={key:1,class:"single-line"},wt={key:1,class:"vertical-text zigen-font"},Ct={key:2,class:"vertical-text zigen-font"},St={key:3,class:"vertical-text zigen-font"},zt={key:4,class:"vertical-text zigen-font"},Et={key:5,class:"vertical-text zigen-font"},$t={key:6,class:"vertical-text zigen-font"},Lt={key:7,class:"vertical-text zigen-font"},Tt={key:8,class:"vertical-text single-line zigen-font"},At={class:"mobile-key-label"},Zt={key:0,class:"mobile-zigen-container"},Dt={class:"mobile-zigen-list text-indigo-800 dark:text-indigo-300"},Mt=["onClick"],Nt={class:"zigen-code"},Pt={key:1,class:"mobile-no-zigen"},qt={key:0,class:"mobile-key-desc zigen-font"},Kt={key:1,class:"mobile-key-desc zigen-font"},Bt={key:2,class:"mobile-key-desc zigen-font"},Ut={key:3,class:"mobile-key-desc zigen-font"},Wt={key:4,class:"mobile-key-desc"},jt={key:4,class:"pinned-popup"},Rt={class:"popup-container"},Vt={class:"popup-body"},Ft={class:"popup-header"},Ht={class:"popup-title"},It={class:"zigen-rows text-indigo-800 dark:text-indigo-300"},Ot={class:"zigen-row-inline"},Qt={class:"zigen-header-inline current-zigen"},Xt={key:0,class:"example-chars-same-line"},Gt=["onClick","title"],Yt={key:1,class:"example-chars-same-line"},Jt={key:0,class:"pinyin-info"},es={class:"zigen-row-inline"},ts={class:"zigen-header-inline other-zigen"},ss={key:0,class:"example-chars-same-line"},os=["onClick","title"],ns={key:1,class:"example-chars-same-line"},ls={key:0,class:"pinyin-info"},ie=7,as=ze({__name:"ZigenMap",props:{defaultScheme:{},columnMinWidth:{},zigenFontClass:{},alwaysVisibleZigens:{},alwaysRedZigens:{},readExamplesFromCsv:{type:Boolean},customEmptyKeyLabels:{},schemeCnName:{},customFooter:{}},setup(me){const d=me,L=O(()=>d.readExamplesFromCsv===!0),$=O(()=>d.zigenFontClass||"zigen-font"),Q=O(()=>{if(d.alwaysVisibleZigens)return d.alwaysVisibleZigens;switch(q.value){default:return"å†«å·´ç”¨è‰¹"}}),oe=O(()=>{if(d.alwaysRedZigens)return d.alwaysRedZigens;switch(q.value){case"star":return"ä¸Šå°å£ã€€ä¸‰å…«éº»ç‰™ã€€åˆå°¤å°¢ç”±èˆŸè‰¹ã€€äººæ–‡äº†ä¸šå†Šã€€ä¸ƒå¿ƒè‡¼ã€€çŸ¢ä¸–åæ­¢è‡ªã€€ä¸å¤Šå¤‚é¬¥ã€€äºŒå„¿è€Œ";case"joy":return"å£";case"ling":return"";case"ming":return"";default:return""}}),Y=Le(d,"columnMinWidth"),ne=O(()=>`repeat(auto-fill, minmax(${Y.value||"1.0rem"}, max-content))`),M=[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l",";"],["z","x","c","v","b","n","m",",",".","/"]],k=["'"],T=S(!1),w=S(!1),z=S(!0),A=S(!1),N=S(!1),J=()=>{T.value=window.innerWidth<720},P=()=>{w.value=!w.value},W=()=>{z.value=!z.value},se=()=>{A.value=!A.value},X=()=>{N.value=!N.value};be(()=>{J(),window.addEventListener("resize",J)}),Ee(()=>{window.removeEventListener("resize",J)});const le=O(()=>{const l=M.flat();return z.value?l.slice().sort((e,r)=>{const t=/^[a-zA-Z]$/.test(e),c=/^[a-zA-Z]$/.test(r);return t&&!c?-1:!t&&c?1:e.localeCompare(r)}):l}),pe=["joy","light","star","ming","wafel","ling"];function Z(l){const e=pe.includes(l);return{zigenUrl:`/zigen-${l}.csv`,chaifenUrl:e?"/chaifen.json":`/chaifen-${l}.json`}}const q=O(()=>d.defaultScheme||"star"),y=S(),K=S(),F=S(!1),B=S(new Map),H=S(0),f=S(null),E=S(null),m=S({}),j=S(!1),D=S(new Set),g=S(!1),v=S("");ke(()=>d.defaultScheme,()=>{K.value=null,B.value.clear(),H.value=0,console.log("æ–¹æ¡ˆå·²åˆ‡æ›ï¼Œå·²æ¸…é™¤ä¾‹å­—ç·©å­˜")});const C=O(()=>{var r;if(!y.value)return console.log("No zigenMap data"),{};console.log("ZigenMap has data, size:",y.value.size);const l={},e=[];for(const[t,c]of y.value){const n=c.font,u=(r=c.ma)==null?void 0:r.trim();if(!u||u.length===0||n==null)continue;const i=u[0].toLowerCase(),p=u.slice(1);e.push({font:n,ma:u,firstLetter:i,code:p})}console.log(`Found ${e.length} valid zigens`);for(let t=0;t<e.length;t++){const c=e[t],{font:n,ma:u,firstLetter:i,code:p}=c;l[i]||(l[i]={visible:[],hidden:[],all:[]});const x=t>0?e[t-1]:null,U=x&&x.code===p&&x.firstLetter===i,te=l[i].visible.find(de=>de.code===p),ve=Q.value.includes(n);let I=!1;te?U&&!ve?(l[i].hidden.push({font:n,code:p}),I=!0):(l[i].visible.push({font:n,code:p}),I=!1):(l[i].visible.push({font:n,code:p}),I=!1),l[i].all.push({font:n,code:p,isHidden:I})}return console.log("Final result:",l),l}),ae=O(()=>{var r;if(!y.value)return{};const l={};for(const t of le.value)l[t]=[];const e=[];for(const[t,c]of y.value){const n=c.font,u=(r=c.ma)==null?void 0:r.trim();if(!u||u.length===0||n==null)continue;const i=u[0].toLowerCase(),p=u.slice(1);e.push({font:n,ma:u,firstLetter:i,code:p})}A.value&&e.sort((t,c)=>t.firstLetter!==c.firstLetter?0:t.code.length!==c.code.length?t.code.length-c.code.length:0);for(let t=0;t<e.length;t++){const c=e[t],{font:n,ma:u,firstLetter:i,code:p}=c,x=t>0?e[t-1]:null,U=x&&x.code===p&&x.firstLetter===i,te=l[i].find(de=>de.code===p&&!de.isHidden),ve=Q.value.includes(n);let I=!1;te&&U&&!ve?I=!0:I=!1,l[i].push({font:n,code:p,isHidden:I})}return l}),ee=async l=>{const e=l.normalize("NFC");let r=new Set;if(B.value.has(e))return r=B.value.get(e),console.log(`âœ… å¾ç·©å­˜ä¸­ç²å–å­—æ ¹ "${e}" çš„ä¾‹å­— ${r.size} å€‹`),Array.from(r).slice(0,ie);if(L.value){if(!y.value)return console.log("zigenMap æœªåˆå§‹åŒ–"),[];for(const[t,c]of y.value)if(c.font===e&&c.examples){const n=c.examples.split(/[,\s]+/).filter(u=>u.length>0);return r=new Set(n),B.value.set(e,r),console.log(`âœ… å¾ zigen æ•¸æ“šç²å–å­—æ ¹ "${e}" çš„ä¾‹å­— ${r.size} å€‹`),Array.from(r).slice(0,ie)}return console.log(`æœªåœ¨ zigen æ•¸æ“šä¸­æ‰¾åˆ°å­—æ ¹ "${e}" çš„ä¾‹å­—`),[]}if(!K.value){console.log("åˆå§‹åŒ–æ‹†åˆ†æ•¸æ“šåŠ è¼‰å™¨...");const t=Z(q.value);K.value=fe.getInstance(t.chaifenUrl),console.log(`å·²åˆå§‹åŒ– ChaiDataLoaderï¼Œä½¿ç”¨æ–‡ä»¶: ${t.chaifenUrl}`)}try{console.log(`é–‹å§‹ç‚ºå­—æ ¹ "${l}(${e})" æœç´¢ä¾‹å­—, cachedCheckedCount=${H.value}...`);const t=new Promise((i,p)=>{setTimeout(()=>p(new Error("æ•¸æ“šåŠ è¼‰è¶…æ™‚")),1e4)}),c=await Promise.race([K.value.loadData(),t]),n=Object.entries(c).slice(0,3);console.log("æ•¸æ“šæ¨£æœ¬:",n);let u=0;for(const[i,p]of Object.entries(c).slice(H.value)){u++;const x=p;if(u<=5&&console.log(`å­—ç¬¦ "${i}" çš„æ‹†åˆ†æ•¸æ“š:`,x.d),x.d){for(const U of x.d){B.value.has(U)||B.value.set(U,new Set);const te=B.value.get(U);te.size<20&&te.add(i),U===e&&(r=te,console.log(`âœ… æ‰¾åˆ°åŒ¹é…: "${i}" åŒ…å«å­—æ ¹ "${e}", æ‹†åˆ†: "${x.d}"`))}if(r.size>=20)break}u%1e3===0&&console.log(`å·²æª¢æŸ¥ ${u} å€‹å­—ç¬¦ï¼Œæ‰¾åˆ° ${r.size} å€‹ä¾‹å­—`)}return H.value+=u,console.log(`å­—æ ¹ "${e}" æœ€çµ‚æ‰¾åˆ°ä¾‹å­—:`,Array.from(r).slice(0,5),`(ç¸½å…±${r.size}å€‹)`),Array.from(r)}catch(t){return console.error("ç²å–ä¾‹å­—å¤±æ•—:",t),t instanceof Error&&t.message==="æ•¸æ“šåŠ è¼‰è¶…æ™‚"&&console.error("æ•¸æ“šåŠ è¼‰è¶…æ™‚ï¼Œè«‹æª¢æŸ¥ç¶²çµ¡é€£æ¥"),Array.from(r)}},ge=async l=>{const e=l.normalize("NFC");let r=new Set;if(L.value){if(!y.value)return console.log("zigenMap æœªåˆå§‹åŒ–"),[];for(const[t,c]of y.value)if(c.font===e&&c.examples){const n=c.examples.split(/[,\s]+/).filter(u=>u.length>0);return r=new Set(n),console.log(`âœ… å¾ zigen æ•¸æ“šç²å–å­—æ ¹ "${e}" çš„æ‰€æœ‰ä¾‹å­— ${r.size} å€‹`),Array.from(r)}return console.log(`æœªåœ¨ zigen æ•¸æ“šä¸­æ‰¾åˆ°å­—æ ¹ "${e}" çš„ä¾‹å­—`),[]}if(!K.value){console.log("åˆå§‹åŒ–æ‹†åˆ†æ•¸æ“šåŠ è¼‰å™¨...");const t=Z(q.value);K.value=fe.getInstance(t.chaifenUrl),console.log(`å·²åˆå§‹åŒ– ChaiDataLoaderï¼Œä½¿ç”¨æ–‡ä»¶: ${t.chaifenUrl}`)}try{console.log(`é–‹å§‹ç‚ºå­—æ ¹ "${l}" æœç´¢æ‰€æœ‰ä¾‹å­—...`);const t=new Promise((n,u)=>{setTimeout(()=>u(new Error("æ•¸æ“šåŠ è¼‰è¶…æ™‚")),3e4)}),c=await Promise.race([K.value.loadData(),t]);for(const[n,u]of Object.entries(c)){const i=u;i.d&&i.d.includes(e)&&r.add(n)}return console.log(`å­—æ ¹ "${e}" æ‰¾åˆ°æ‰€æœ‰ä¾‹å­—: ${r.size} å€‹`),Array.from(r)}catch(t){return console.error("ç²å–æ‰€æœ‰ä¾‹å­—å¤±æ•—:",t),Array.from(r)}};async function re(){F.value=!0;try{const l=Z(q.value),e=await Ae(l.zigenUrl);y.value=e,console.log("æˆ‘å°±çŸ¥é“ä½ æœƒå¿ä¸ä½æ‰“é–‹æ§åˆ¶è‡ºğŸ˜"),console.log(`å·²åŠ è¼‰å­—æ ¹æ•¸æ“šï¼Œæ–‡ä»¶: ${l.zigenUrl}`),console.log("æ³¨æ„ï¼šæ‹†åˆ†æ•¸æ“šå°‡åœ¨ç¬¬ä¸€æ¬¡é»æ“Šå­—æ ¹æ™‚æ‰åŠ è¼‰")}catch(l){console.error("åŠ è¼‰å­—æ ¹æ•¸æ“šå¤±æ•—:",l)}finally{F.value=!1}}function ce(l){switch(l){case";":return"æ¬¡é¸";case",":return"é€—è™Ÿ";case".":return"å¥è™Ÿ";default:return"æ— å­—æ ¹"}}function G(l){return d.customEmptyKeyLabels&&d.customEmptyKeyLabels[l]||null}async function he(l,e){var u;if(l.stopPropagation(),!K.value){console.log("é»æ“Šæ™‚åˆå§‹åŒ–æ‹†åˆ†æ•¸æ“šåŠ è¼‰å™¨...");const i=Z(q.value);K.value=fe.getInstance(i.chaifenUrl),console.log(`å·²åˆå§‹åŒ– ChaiDataLoaderï¼Œä½¿ç”¨æ–‡ä»¶: ${i.chaifenUrl}`)}if(j.value&&f.value===e.font){ue();return}f.value=e.font,j.value=!0;let r="";if(y.value){for(const[i,p]of y.value)if(p.font===e.font&&((u=p.ma)==null?void 0:u.slice(1))===e.code){r=p.ma;break}}const t=Se(e.font,r);E.value=t,console.log("é–‹å§‹ç²å–ä¾‹å­—ï¼Œå­—æ ¹æ•¸é‡:",[...t.visible,...t.hidden].length);const c={},n=[...t.visible,...t.hidden];for(const i of n){console.log(`æ­£åœ¨ç²å–å­—æ ¹ "${i.font}" çš„ä¾‹å­—...`);const p=await ee(i.font);console.log(`å­—æ ¹ "${i.font}" æ‰¾åˆ°ä¾‹å­—:`,p.length,"å€‹"),c[i.font]=p}m.value=c,console.log(`å›ºå®šå½ˆçª— - å­—æ ¹ "${e.font}" çš„æœ€çµ‚ä¾‹å­—:`,m.value)}function ue(){j.value=!1,f.value=null,E.value=null,m.value={},D.value.clear()}async function ye(l){var e;if(D.value.has(l))D.value.delete(l);else if(D.value.add(l),((e=m.value[l])==null?void 0:e.length)<=ie){console.log(`æ­£åœ¨åŠ è¼‰å­—æ ¹ "${l}" çš„æ‰€æœ‰ä¾‹å­—...`);const r=await ge(l);m.value[l]=r,console.log(`å·²åŠ è¼‰å­—æ ¹ "${l}" çš„ ${r.length} å€‹ä¾‹å­—`)}}async function xe(){if(!g.value){g.value=!0,v.value="";try{const l=document.querySelector(".zigen-map-container");if(!l)throw new Error("æ‰¾ä¸åˆ°å­—æ ¹åœ–å®¹å™¨å…ƒç´ ");j.value&&ue(),await new Promise(t=>setTimeout(t,100));const e=d.schemeCnName||Ce.getSchemeDisplayName(q.value),r=await Ce.exportZigenMapToPNG(l,e,w.value,{copyToClipboard:!1,download:!0,scale:3,addWatermark:!0,customFooter:d.customFooter});r.success?(v.value=r.message,setTimeout(()=>{v.value=""},3e3)):(v.value=r.message,setTimeout(()=>{v.value=""},5e3))}catch(l){console.error("å°å‡ºå­—æ ¹åœ–å¤±æ•—:",l),v.value=`å°å‡ºå¤±æ•—: ${l instanceof Error?l.message:"æœªçŸ¥éŒ¯èª¤"}`,setTimeout(()=>{v.value=""},5e3)}finally{g.value=!1}}}function _e(l,e){return e&&oe.value.includes(e)?!0:["ling","ming"].includes(q.value)?l.length===1:!1}function Se(l,e){var c,n;const r=[],t=[];if(!y.value||!e)return{visible:r,hidden:t};for(const[u,i]of y.value){const p=i.font,x=(c=i.ma)==null?void 0:c.trim(),U=(n=i.pinyin)==null?void 0:n.trim();!x||!p||p===null||p===void 0||x===e&&(p===l?r.unshift({font:p,code:x,pinyin:U}):t.push({font:p,code:x,pinyin:U}))}return{visible:r,hidden:t}}return ke(()=>q.value,re),be(()=>{re(),document.addEventListener("click",l=>{if(j.value){const e=document.querySelector(".pinned-popup");e&&!e.contains(l.target)&&ue()}})}),(l,e)=>{var r;return s(),o("div",De,[F.value?(s(),o("div",Me,[...e[0]||(e[0]=[a("div",{class:"loading loading-spinner loading-lg"},null,-1),a("span",{class:"ml-2"},"æ­£åœ¨åŠ è¼‰å­—æ ¹æ•¸æ“š...",-1)])])):b("",!0),F.value?b("",!0):(s(),o("div",Ne,[e[7]||(e[7]=a("div",{class:"text-sm text-gray-500 dark:text-gray-400"}," é»æ“Šå­—æ ¹å¯æŸ¥çœ‹ä¾‹å­— ",-1)),T.value?b("",!0):(s(),o("div",Pe,[a("div",qe,[a("button",{onClick:xe,class:_(["export-btn layout-toggle-btn",{"layout-toggle-active":g.value}]),disabled:g.value,title:g.value?"å°å‡ºä¸­...":"å°å‡ºå­—æ ¹åœ–"},[g.value?(s(),o("span",Ue,"â³")):(s(),o("span",Be,"ğŸ“¸"))],10,Ke),v.value?(s(),o("span",{key:0,class:_(["text-xs",v.value.includes("å¤±æ•—")?"text-red-500":"text-green-500"])},h(v.value),3)):b("",!0)]),a("div",We,[e[1]||(e[1]=a("span",{class:"text-xs text-gray-400"},"ç·¨ç¢¼é•·åº¦",-1)),a("button",{onClick:se,class:_(["layout-toggle-btn",{"layout-toggle-active":A.value}]),title:A.value?"æ¢å¾©åŸå§‹é †åº":"çŸ­ç·¨ç¢¼å„ªå…ˆï¼ˆ2ç¢¼â†’3ç¢¼ï¼‰"},[A.value?(s(),o("span",Ve,"ğŸ“")):(s(),o("span",Re,"ğŸ”¢"))],10,je)]),w.value?(s(),o("div",Fe,[e[2]||(e[2]=a("span",{class:"text-xs text-gray-400"},"æŒ‰éµæ’åº",-1)),a("button",{onClick:W,class:_(["layout-toggle-btn",{"layout-toggle-active":z.value}]),title:z.value?"åˆ‡æ›ç‚ºéµç›¤é †åº":"åˆ‡æ›ç‚ºå­—æ¯é †åº"},[z.value?(s(),o("span",Ie,"ğŸ”¤")):(s(),o("span",Oe,"âŒ¨ï¸"))],10,He)])):b("",!0),w.value?b("",!0):(s(),o("div",Qe,[e[3]||(e[3]=a("span",{class:"text-xs text-gray-400"},"é¡¯ç¤ºæ¨¡å¼",-1)),a("button",{onClick:X,class:_(["layout-toggle-btn",{"layout-toggle-active":N.value}]),title:N.value?"éš±è—é‡ç¢¼å­—æ ¹":"é¡¯ç¤ºæ‰€æœ‰å­—æ ¹"},[N.value?(s(),o("span",Ye,"ğŸ‘ï¸â€ğŸ—¨ï¸")):(s(),o("span",Ge,"ğŸ‘ï¸"))],10,Xe)])),a("div",Je,[e[4]||(e[4]=a("span",{class:"text-xs text-gray-400"},"åˆ‡æ›åœ–è¡¨å½¢æ…‹",-1)),a("button",{onClick:P,class:_(["layout-toggle-btn",{"layout-toggle-active":w.value}]),title:w.value?"åˆ‡æ›ç‚ºç¶²æ ¼å¸ƒå±€":"åˆ‡æ›ç‚ºåˆ—è¡¨å¸ƒå±€"},[w.value?(s(),o("span",st,"âŠ")):(s(),o("span",tt,"â˜°"))],10,et)])])),T.value?(s(),o("div",ot,[a("button",{onClick:xe,class:_(["export-btn layout-toggle-btn",{"layout-toggle-active":g.value}]),disabled:g.value,title:g.value?"å°å‡ºä¸­...":"å°å‡ºå­—æ ¹åœ–"},[g.value?(s(),o("span",at,"â³")):(s(),o("span",lt,"ğŸ“¸"))],10,nt),e[5]||(e[5]=a("span",{class:"text-xs text-gray-400"},"æŒ‰éµæ’åº",-1)),a("button",{onClick:W,class:_(["layout-toggle-btn",{"layout-toggle-active":z.value}]),title:z.value?"åˆ‡æ›ç‚ºéµç›¤é †åº":"åˆ‡æ›ç‚ºå­—æ¯é †åº"},[z.value?(s(),o("span",rt,"ğŸ”¤")):(s(),o("span",ct,"âŒ¨ï¸"))],10,it),e[6]||(e[6]=a("span",{class:"text-xs text-gray-400"},"ç·¨ç¢¼é•·åº¦",-1)),a("button",{onClick:se,class:_(["layout-toggle-btn",{"layout-toggle-active":A.value}]),title:A.value?"æ¢å¾©åŸå§‹é †åº":"çŸ­ç·¨ç¢¼å„ªå…ˆï¼ˆ2ç¢¼â†’3ç¢¼ï¼‰"},[A.value?(s(),o("span",pt,"ğŸ“")):(s(),o("span",dt,"ğŸ”¢"))],10,ut)])):b("",!0),T.value&&v.value?(s(),o("div",vt,[a("span",{class:_(["text-xs",v.value.includes("å¤±æ•—")?"text-red-500":"text-green-500"])},h(v.value),3)])):b("",!0)])),!F.value&&y.value&&!T.value&&!w.value?(s(),o("div",ft,[(s(),o(R,null,V(M,(t,c)=>a("div",{key:c,class:"keyboard-row"},[(s(!0),o(R,null,V(t,n=>{var u;return s(),o("div",{key:n,class:_(["keyboard-key",{"empty-key":k.includes(n)}])},[a("div",mt,h(n.toUpperCase()),1),!k.includes(n)&&((u=C.value[n])==null?void 0:u.visible.length)>0?(s(),o("div",{key:0,class:"zigen-list text-indigo-800 dark:text-indigo-300",style:$e({gridTemplateColumns:ne.value})},[(s(!0),o(R,null,V(A.value?[...N.value?C.value[n].all:C.value[n].all.filter(i=>!i.isHidden)].sort((i,p)=>i.code.length-p.code.length):N.value?C.value[n].all:C.value[n].all.filter(i=>!i.isHidden),(i,p)=>(s(),o("span",{key:p,class:_(["zigen-item",{"small-root-zigen":_e(i.code,i.font)}]),onClick:x=>he(x,i)},[a("span",{class:_($.value)},h(i.font),3),a("span",ht,h(i.code),1)],10,gt))),128)),!N.value&&C.value[n].hidden.length>0?(s(),o("span",yt,"â‹¯")):b("",!0)],4)):k.includes(n)?b("",!0):(s(),o("div",xt,[G(n)?(s(),o("div",_t,[Array.isArray(G(n))?(s(),o("div",bt,[(s(!0),o(R,null,V(G(n),(i,p)=>(s(),o("div",{key:p},h(i),1))),128))])):(s(),o("div",kt,h(G(n)),1))])):n==="/"?(s(),o("div",wt,[...e[8]||(e[8]=[a("div",null,"å¼•å°ç‰¹æ®Šç¬¦è™Ÿ",-1),a("div",null,"åˆ‡æ›å¤šé‡è¨»è§£",-1)])])):n==="z"?(s(),o("div",Ct,[...e[9]||(e[9]=[a("div",null,"å¼•å°æ‹¼éŸ³åæŸ¥",-1),a("div",null,"å¼•å°æ­·å²è¼¸å…¥",-1)])])):n==="a"?(s(),o("div",St,[...e[10]||(e[10]=[a("div",null,null,-1),a("div",null,"ä¸€ç¢¼ä¸Šå±å­—ã€€äº†",-1)])])):n==="e"?(s(),o("div",zt,[...e[11]||(e[11]=[a("div",null,null,-1),a("div",null,"ä¸€ç¢¼ä¸Šå±å­—ã€€çš„",-1)])])):n==="i"?(s(),o("div",Et,[...e[12]||(e[12]=[a("div",null,null,-1),a("div",null,"ä¸€ç¢¼ä¸Šå±å­—ã€€æ˜¯",-1)])])):n==="o"?(s(),o("div",$t,[...e[13]||(e[13]=[a("div",null,null,-1),a("div",null,"ä¸€ç¢¼ä¸Šå±å­—ã€€æˆ‘",-1)])])):n==="u"?(s(),o("div",Lt,[...e[14]||(e[14]=[a("div",null,null,-1),a("div",null,"ä¸€ç¢¼ä¸Šå±å­—ã€€ä¸",-1)])])):(s(),o("div",Tt,h(ce(n)),1))]))],2)}),128))])),64))])):b("",!0),!F.value&&y.value&&(T.value||w.value)?(s(),o("div",{key:3,class:_(["mobile-layout",{"desktop-list-layout":!T.value&&w.value}])},[(s(!0),o(R,null,V(le.value,t=>{var c;return s(),o("div",{key:t,class:_(["mobile-key-row",{"empty-mobile-key":k.includes(t)}])},[a("div",At,h(t.toUpperCase()),1),!k.includes(t)&&((c=ae.value[t])==null?void 0:c.length)>0?(s(),o("div",Zt,[a("div",Dt,[(s(!0),o(R,null,V(ae.value[t],(n,u)=>(s(),o("span",{key:`sorted-${u}`,class:_(["mobile-zigen-item",{"mobile-hidden-zigen":n.isHidden,"mobile-small-root-zigen":!n.isHidden&&_e(n.code,n.font)}]),onClick:i=>he(i,n)},[a("span",{class:_($.value)},h(n.font),3),a("span",Nt,h(n.code),1)],10,Mt))),128))])])):k.includes(t)?b("",!0):(s(),o("div",Pt,[G(t)?(s(),o("span",qt,h(Array.isArray(G(t))?G(t)[0]:G(t)),1)):t==="/"?(s(),o("span",Kt,"å¼•å°ç‰¹æ®Šç¬¦è™Ÿ")):t==="z"?(s(),o("span",Bt,"å¼•å°æ‹¼éŸ³åæŸ¥")):["a","e","i","o","u"].includes(t)?(s(),o("span",Ut," ä¸€ç¢¼ä¸Šå±å­— ")):(s(),o("span",Wt,h(ce(t)),1))]))],2)}),128))],2)):b("",!0),j.value&&f.value&&E.value?(s(),o("div",jt,[a("div",Rt,[a("div",Vt,[a("div",Ft,[a("h3",Ht," ç·¨ç¢¼ "+h(((r=E.value.visible[0])==null?void 0:r.code)||f.value)+" ä¸Šçš„å­—æ ¹ ",1),a("button",{onClick:ue,class:"close-btn"},"âœ•")]),a("div",It,[(s(!0),o(R,null,V(E.value.visible,(t,c)=>{var n;return s(),o("div",{key:`pinned-visible-${c}`,class:"zigen-row-wrapper"},[a("div",Ot,[a("div",Qt,[a("span",{class:_($.value)},h(t.font),3)]),((n=m.value[t.font])==null?void 0:n.length)>0?(s(),o("div",Xt,[(s(!0),o(R,null,V(D.value.has(t.font)?m.value[t.font]:m.value[t.font].slice(0,ie),u=>(s(),o("span",{key:u,class:"example-char zigen-font"},h(u),1))),128)),a("button",{onClick:we(u=>ye(t.font),["stop"]),class:"example-char expand-btn",type:"button",title:D.value.has(t.font)?"æ”¶èµ·":"å±•é–‹é¡¯ç¤ºæ‰€æœ‰ä¾‹å­—"},h(D.value.has(t.font)?"â–²":"â–¼"),9,Gt)])):L.value?b("",!0):(s(),o("div",Yt,[...e[15]||(e[15]=[a("span",{class:"loading-text"},"æ­£åœ¨åŠ è¼‰...",-1)])]))]),t.pinyin?(s(),o("div",Jt,h(t.pinyin),1)):b("",!0)])}),128)),(s(!0),o(R,null,V(E.value.hidden,(t,c)=>{var n;return s(),o("div",{key:`pinned-hidden-${c}`,class:"zigen-row-wrapper"},[a("div",es,[a("div",ts,[a("span",{class:_($.value)},h(t.font),3)]),((n=m.value[t.font])==null?void 0:n.length)>0?(s(),o("div",ss,[(s(!0),o(R,null,V(D.value.has(t.font)?m.value[t.font]:m.value[t.font].slice(0,ie),u=>(s(),o("span",{key:u,class:"example-char zigen-font"},h(u),1))),128)),a("button",{onClick:we(u=>ye(t.font),["stop"]),class:"example-char expand-btn",type:"button",title:D.value.has(t.font)?"æ”¶èµ·":"å±•é–‹é¡¯ç¤ºæ‰€æœ‰ä¾‹å­—"},h(D.value.has(t.font)?"â–²":"â–¼"),9,os)])):L.value?b("",!0):(s(),o("div",ns,[...e[16]||(e[16]=[a("span",{class:"loading-text"},"æ­£åœ¨åŠ è¼‰...",-1)])]))]),t.pinyin?(s(),o("div",ls,h(t.pinyin),1)):b("",!0)])}),128))])])])])):b("",!0)])}}}),us=Te(as,[["__scopeId","data-v-40dd8ce4"]]);export{us as Z};
