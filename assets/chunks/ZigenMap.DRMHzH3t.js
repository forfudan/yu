import{d as Ce,l as xe,y as Se,v as _e,o as s,c as o,m as i,e as C,n as _,t as g,F as U,C as R,O as ze,a0 as be,k as G,j as $,a7 as Ee,_ as $e}from"./framework.72Ik0KeM.js";import{a as Le,C as Te}from"./share.Dv-cn20s.js";import{h as Ae}from"./html2canvas-pro.esm.C4LuxvEu.js";class ke{static generateFileName(c="æœªå‘½åæ–¹æ¡ˆ",A=!1){const D=new Date().toISOString().split("T")[0].replace(/-/g,"");return`${c}è¼¸å…¥æ³•${A?"å­—æ ¹è¡¨":"å­—æ ¹åœ–"}${D}.png`}static addTemporaryWatermark(c,A="å®‡æµ©ç³»åˆ—è¼¸å…¥æ³• Â· å®˜ç¶²: shurufa.app Â· QQ è¨è«–ç¾¤: 170510762"){const D=document.createElement("div");return D.className="zigen-export-watermark",D.style.cssText=`
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            text-align: center;
            margin-top: 16px;
            font-size: 0.9rem;
            color: #4f46e5;
            font-weight: 500;
            border: 1px solid #d1d5db;
            font-family: 'Noto Serif SC', serif;
            backdrop-filter: blur(4px);
        `,D.textContent=A,c.appendChild(D),D}static removeTemporaryWatermark(c){c&&c.parentNode&&c.parentNode.removeChild(c)}static async exportZigenMapToPNG(c,A="æœªå‘½åæ–¹æ¡ˆ",D=!1,Y={}){const{copyToClipboard:oe=!0,download:J=!0,scale:se=2,addWatermark:S=!0,customFooter:b}=Y,k="#ffffff";let L=null;if(S){const V=b||"å®‡æµ©ç³»åˆ—è¼¸å…¥æ³• Â· å®˜ç¶²: shurufa.app Â· QQ è¨è«–ç¾¤: 170510762";L=this.addTemporaryWatermark(c,V)}let z,P=[],O,ne=[],M=[],K=null,le=[];try{document.querySelectorAll(".dark").forEach(f=>{const h=f.classList.contains("dark");le.push({element:f,hadDarkClass:h}),h&&f.classList.remove("dark")}),z=c.querySelectorAll(".layout-toggle-btn, .export-btn"),z.forEach((f,h)=>{const y=f;P[h]=y.style.display,y.style.display="none"}),O=c.querySelectorAll(".text-sm.text-gray-500, .text-xs.text-gray-400"),O.forEach((f,h)=>{var Z,T,m,v,N;const y=f;((Z=y.textContent)!=null&&Z.includes("é»æ“Šå­—æ ¹å¯æŸ¥çœ‹ä¾‹å­—")||(T=y.textContent)!=null&&T.includes("åˆ‡æ›åœ–è¡¨å½¢æ…‹")||(m=y.textContent)!=null&&m.includes("æŒ‰éµæ’åº")||(v=y.textContent)!=null&&v.includes("ç·¨ç¢¼é•·åº¦")||(N=y.textContent)!=null&&N.includes("é¡¯ç¤ºæ¨¡å¼"))&&(ne[h]=y.style.display,y.style.display="none")}),K=document.createElement("div"),K.className="export-title",K.style.cssText=`
                text-align: center;
                font-size: 1.5rem;
                font-weight: bold;
                margin-bottom: 1.5rem;
                color: #5400a2ff;
                font-family: 'Noto Serif SC', serif;
            `;const re=c.querySelector(".desktop-list-layout")!==null||c.querySelector(".mobile-key-row")!==null,ce=re?"å­—æ ¹è¡¨":"å­—æ ¹åœ–";K.textContent=`${A}è¼¸å…¥æ³•${ce}`,c.insertBefore(K,c.firstChild),M.push({element:c,originalStyle:c.style.cssText}),c.style.cssText+=`
                min-width: 1028px !important;    /* å­—æ ¹åœ–çš„æœ€å°å¯¬åº¦ */
                width: auto !important;          
                overflow: visible !important;    
                box-sizing: border-box !important; 
            `;const E=c.querySelector(".keyboard-layout");E&&(M.push({element:E,originalStyle:E.style.cssText}),E.style.cssText+=`
                    min-width: 1028px !important;    
                    width: auto !important;          
                    overflow: visible !important;    
                    box-sizing: border-box !important; 
                `,E.querySelectorAll(".keyboard-key").forEach(m=>{const v=m;M.push({element:v,originalStyle:v.style.cssText}),v.style.cssText+=`
                        width: 96px !important;          /* æŒ‰éµå¡ç‰‡å›ºå®šå¯¬åº¦ */
                        flex: 0 0 96px !important;       /* å›ºå®šå½ˆæ€§ä½ˆå±€ */
                    `}),E.querySelectorAll(".zigen-list").forEach(m=>{const v=m;M.push({element:v,originalStyle:v.style.cssText}),v.style.cssText+=`
                        grid-template-columns: repeat(auto-fill, minmax(16px, max-content)) !important; /* å­—æ ¹æœ€å°å¯¬åº¦ */
                    `}),E.querySelectorAll(".zigen-code").forEach(m=>{const v=m;M.push({element:v,originalStyle:v.style.cssText}),v.style.cssText+=`
                        margin-top: 1px !important;
                        padding-top: 1px !important;
                        min-height: 8px !important;
                        line-height: 1.0 !important;
                    `}),E.querySelectorAll(".zigen-item").forEach(m=>{const v=m;M.push({element:v,originalStyle:v.style.cssText}),v.style.cssText+=`
                        gap: 1px !important;
                        padding: 1px !important;
                    `;const N=m.querySelector(".zigen-code");N&&(M.push({element:N,originalStyle:N.style.cssText}),N.style.cssText+=`
                            margin-top: 1px !important;
                            min-height: 2px !important;
                        `)}),E.querySelectorAll(".keyboard-key").forEach(m=>{var N,ue;const v=(ue=(N=m.querySelector(".key-label"))==null?void 0:N.textContent)==null?void 0:ue.toLowerCase();if(["z",";",",",".","/"].includes(v||"")){const ee=m.querySelector(".no-zigen-text");ee&&(M.push({element:ee,originalStyle:ee.style.cssText}),ee.style.cssText=`
                                display: flex !important;
                                flex-direction: column !important;
                                align-items: center !important;
                                justify-content: center !important;
                                text-align: center !important;
                                font-size: 0.7rem !important;
                                height: 100% !important;
                                line-height: 1.3 !important;
                                padding: 0.2rem !important;
                            `,ee.querySelectorAll("div").forEach(de=>{const j=de;j.style.cssText=`
                                    writing-mode: horizontal-tb !important;
                                    text-orientation: mixed !important;
                                    white-space: nowrap !important;
                                    margin: 0.1rem 0 !important;
                                    text-align: center !important;
                                    font-size: 0.65rem !important;
                                `}))}})),await new Promise(f=>setTimeout(f,500));const x=c.getBoundingClientRect(),B=Math.max(x.width,c.scrollWidth,1028),H=Math.max(x.height,c.scrollHeight),F=await Ae(c,{backgroundColor:k,scale:se,useCORS:!0,allowTaint:!1,logging:!0,width:B,height:H,windowWidth:B,windowHeight:H,scrollX:0,scrollY:0,x:0,y:0,ignoreElements:f=>f.classList.contains("export-btn")||f.classList.contains("layout-toggle-btn")||f.classList.contains("pinned-popup"),foreignObjectRendering:!1,removeContainer:!1,imageTimeout:15e3});this.restoreAllChanges(z,P,O,ne,M,K,le);const Q=F.toDataURL("image/png",1),W=this.generateFileName(A,re);if(oe&&this.isClipboardSupported())try{const f=await new Promise(h=>{F.toBlob(y=>{y&&h(y)},"image/png",1)});return await navigator.clipboard.write([new ClipboardItem({"image/png":f})]),console.log("å­—æ ¹åœ–å·²è¤‡è£½åˆ°å‰ªè²¼æ¿"),{success:!0,message:"å­—æ ¹åœ–å·²è¤‡è£½åˆ°å‰ªè²¼æ¿ä¸¦ä¸‹è¼‰",dataUrl:Q,filename:W}}catch(f){console.warn("è¤‡è£½åˆ°å‰ªè²¼æ¿å¤±æ•—ï¼Œå°‡åƒ…é€²è¡Œä¸‹è¼‰:",f)}if(J){const f=document.createElement("a");f.download=W,f.href=Q,f.style.display="none",document.body.appendChild(f),f.click(),document.body.removeChild(f),console.log("å­—æ ¹åœ–å·²ä¸‹è¼‰:",W)}return{success:!0,message:"å­—æ ¹åœ–å·²ä¸‹è¼‰",dataUrl:Q,filename:W}}catch(V){return console.error("å°å‡ºå­—æ ¹åœ–å¤±æ•—:",V),this.restoreAllChanges(z,P,O,ne,M,K,le),{success:!1,message:`å°å‡ºå¤±æ•—: ${V instanceof Error?V.message:"æœªçŸ¥éŒ¯èª¤"}`,dataUrl:"",filename:""}}finally{L&&this.removeTemporaryWatermark(L)}}static restoreAllChanges(c,A,D,Y,oe,J,se){se.forEach(({element:S,hadDarkClass:b})=>{b&&S.classList.add("dark")}),c.forEach((S,b)=>{const k=S;k.style.display=A[b]}),D.forEach((S,b)=>{const k=S;Y[b]!==void 0&&(k.style.display=Y[b])}),J&&J.parentNode&&J.remove(),oe.forEach(({element:S,originalStyle:b})=>{S.style.cssText=b,S.querySelectorAll("div").forEach(L=>{const z=L;z.style.cssText=""})})}static isClipboardSupported(){return typeof navigator<"u"&&"clipboard"in navigator&&"write"in navigator.clipboard}static getSchemeDisplayName(c){return{joy:"å¿é›²",light:"å…‰è¯",star:"æ˜Ÿé™³",ming:"æ—¥æœˆ",ling:"éˆæ˜",wafel:"å‰æ—¦é¤…",tianma:"å¤©ç¢¼"}[c]||c}}const Ze={class:"zigen-map-container"},De={key:0,class:"flex justify-center items-center py-8"},Me={key:1,class:"flex justify-between items-center mb-4 px-5"},Ne={key:0,class:"flex items-center space-x-4"},Pe={class:"flex items-center space-x-2"},qe=["disabled","title"],Ke={key:0},Be={key:1},Fe={class:"flex items-center space-x-2"},We=["title"],je={key:0},Ue={key:1},Re={key:0,class:"flex items-center space-x-2"},Ve=["title"],He={key:0},Ie={key:1},Oe={key:1,class:"flex items-center space-x-2"},Qe=["title"],Xe={key:0},Ge={key:1},Ye={class:"flex items-center space-x-2"},Je=["title"],et={key:0},tt={key:1},st={key:1,class:"flex items-center space-x-2"},ot=["disabled","title"],nt={key:0},lt={key:1},at=["title"],it={key:0},rt={key:1},ct=["title"],ut={key:0},dt={key:1},pt={key:2,class:"mt-2 text-center"},ft={key:2,class:"keyboard-layout"},mt={class:"key-label"},vt=["onClick"],gt={class:"zigen-code"},ht={key:0,class:"more-indicator"},yt={key:1,class:"text-xs text-gray-400 no-zigen-text"},xt={key:0,class:"vertical-text zigen-font"},_t={key:0},bt={key:1,class:"single-line"},kt={key:1,class:"vertical-text zigen-font"},wt={key:2,class:"vertical-text zigen-font"},Ct={key:3,class:"vertical-text zigen-font"},St={key:4,class:"vertical-text zigen-font"},zt={key:5,class:"vertical-text zigen-font"},Et={key:6,class:"vertical-text zigen-font"},$t={key:7,class:"vertical-text zigen-font"},Lt={key:8,class:"vertical-text single-line zigen-font"},Tt={class:"mobile-key-label"},At={key:0,class:"mobile-zigen-container"},Zt={class:"mobile-zigen-list text-indigo-800 dark:text-indigo-300"},Dt=["onClick"],Mt={class:"zigen-code"},Nt={key:1,class:"mobile-no-zigen"},Pt={key:0,class:"mobile-key-desc zigen-font"},qt={key:1,class:"mobile-key-desc zigen-font"},Kt={key:2,class:"mobile-key-desc zigen-font"},Bt={key:3,class:"mobile-key-desc zigen-font"},Ft={key:4,class:"mobile-key-desc"},Wt={key:4,class:"pinned-popup"},jt={class:"popup-container"},Ut={class:"popup-body"},Rt={class:"popup-header"},Vt={class:"popup-title"},Ht={class:"zigen-rows text-indigo-800 dark:text-indigo-300"},It={class:"zigen-row-inline"},Ot={class:"zigen-header-inline current-zigen"},Qt={key:0,class:"example-chars-same-line"},Xt=["onClick","title"],Gt={key:1,class:"example-chars-same-line"},Yt={key:0,class:"pinyin-info"},Jt={class:"zigen-row-inline"},es={class:"zigen-header-inline other-zigen"},ts={key:0,class:"example-chars-same-line"},ss=["onClick","title"],os={key:1,class:"example-chars-same-line"},ns={key:0,class:"pinyin-info"},ae=7,ls=Ce({__name:"ZigenMap",props:{defaultScheme:{},columnMinWidth:{},zigenFontClass:{},alwaysVisibleZigens:{},alwaysRedZigens:{},searchExamplesFromChaifen:{type:Boolean},customEmptyKeyLabels:{},schemeCnName:{},customFooter:{}},setup(ie){const c=ie,A=G(()=>c.zigenFontClass||"zigen-font"),D=G(()=>{if(c.alwaysVisibleZigens)return c.alwaysVisibleZigens;switch(E.value){default:return"å†«å·´ç”¨è‰¹"}}),Y=G(()=>{if(c.alwaysRedZigens)return c.alwaysRedZigens;switch(E.value){case"star":return"ä¸Šå°å£ã€€ä¸‰å…«éº»ç‰™ã€€åˆå°¤å°¢ç”±èˆŸè‰¹ã€€äººæ–‡äº†ä¸šå†Šã€€ä¸ƒå¿ƒè‡¼ã€€çŸ¢ä¸–åæ­¢è‡ªã€€ä¸å¤Šå¤‚é¬¥ã€€äºŒå„¿è€Œ";case"joy":return"å£";case"ling":return"";case"ming":return"";default:return""}}),oe=Ee(c,"columnMinWidth"),J=G(()=>`repeat(auto-fill, minmax(${oe.value||"1.0rem"}, max-content))`),se=[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l",";"],["z","x","c","v","b","n","m",",",".","/"]],S=["'"],b=$(!1),k=$(!1),L=$(!0),z=$(!1),P=$(!1),O=()=>{b.value=window.innerWidth<720},ne=()=>{k.value=!k.value},M=()=>{L.value=!L.value},K=()=>{z.value=!z.value},le=()=>{P.value=!P.value};xe(()=>{O(),window.addEventListener("resize",O)}),Se(()=>{window.removeEventListener("resize",O)});const V=G(()=>{const l=se.flat();return L.value?l.slice().sort((e,r)=>{const t=/^[a-zA-Z]$/.test(e),u=/^[a-zA-Z]$/.test(r);return t&&!u?-1:!t&&u?1:e.localeCompare(r)}):l}),re=["joy","light","star","ming","wafel","ling"];function ce(l){const e=re.includes(l);return{zigenUrl:`/zigen-${l}.csv`,chaifenUrl:e?"/chaifen.json":`/chaifen-${l}.json`}}const E=G(()=>c.defaultScheme||"star"),x=$(),B=$(),H=$(!1),F=$(new Map),Q=$(0),W=$(null),f=$(null),h=$({}),y=$(!1),Z=$(new Set),T=$(!1),m=$("");_e(()=>c.defaultScheme,()=>{B.value=null,F.value.clear(),Q.value=0,console.log("æ–¹æ¡ˆå·²åˆ‡æ›ï¼Œå·²æ¸…é™¤ä¾‹å­—ç·©å­˜")});const v=G(()=>{var r;if(!x.value)return console.log("No zigenMap data"),{};console.log("ZigenMap has data, size:",x.value.size);const l={},e=[];for(const[t,u]of x.value){const n=u.font,p=(r=u.ma)==null?void 0:r.trim();if(!p||p.length===0||n==null)continue;const a=p[0].toLowerCase(),d=p.slice(1);e.push({font:n,ma:p,firstLetter:a,code:d})}console.log(`Found ${e.length} valid zigens`);for(let t=0;t<e.length;t++){const u=e[t],{font:n,ma:p,firstLetter:a,code:d}=u;l[a]||(l[a]={visible:[],hidden:[],all:[]});const w=t>0?e[t-1]:null,q=w&&w.code===d&&w.firstLetter===a,X=l[a].visible.find(fe=>fe.code===d),te=D.value.includes(n);let I=!1;X?q&&!te?(l[a].hidden.push({font:n,code:d}),I=!0):(l[a].visible.push({font:n,code:d}),I=!1):(l[a].visible.push({font:n,code:d}),I=!1),l[a].all.push({font:n,code:d,isHidden:I})}return console.log("Final result:",l),l}),N=G(()=>{var r;if(!x.value)return{};const l={};for(const t of V.value)l[t]=[];const e=[];for(const[t,u]of x.value){const n=u.font,p=(r=u.ma)==null?void 0:r.trim();if(!p||p.length===0||n==null)continue;const a=p[0].toLowerCase(),d=p.slice(1);e.push({font:n,ma:p,firstLetter:a,code:d})}z.value&&e.sort((t,u)=>t.firstLetter!==u.firstLetter?0:t.code.length!==u.code.length?t.code.length-u.code.length:0);for(let t=0;t<e.length;t++){const u=e[t],{font:n,ma:p,firstLetter:a,code:d}=u,w=t>0?e[t-1]:null,q=w&&w.code===d&&w.firstLetter===a,X=l[a].find(fe=>fe.code===d&&!fe.isHidden),te=D.value.includes(n);let I=!1;X&&q&&!te?I=!0:I=!1,l[a].push({font:n,code:d,isHidden:I})}return l}),ue=async l=>{const e=l.normalize("NFC");let r=new Set;if(F.value.has(e))return r=F.value.get(e),console.log(`âœ… å¾ç·©å­˜ä¸­ç²å–å­—æ ¹ "${e}" çš„ä¾‹å­— ${r.size} å€‹`),Array.from(r).slice(0,ae);if(!(c.searchExamplesFromChaifen!==!1)){if(!x.value)return console.log("zigenMap æœªåˆå§‹åŒ–"),[];for(const[u,n]of x.value)if(n.font===e&&n.examples){const p=n.examples.split(/[,\s]+/).filter(a=>a.length>0);return r=new Set(p),F.value.set(e,r),console.log(`âœ… å¾ zigen æ•¸æ“šç²å–å­—æ ¹ "${e}" çš„ä¾‹å­— ${r.size} å€‹`),Array.from(r).slice(0,ae)}return console.log(`æœªåœ¨ zigen æ•¸æ“šä¸­æ‰¾åˆ°å­—æ ¹ "${e}" çš„ä¾‹å­—`),[]}if(!B.value)return console.log("chaifenLoader æœªåˆå§‹åŒ–"),[];try{console.log(`é–‹å§‹ç‚ºå­—æ ¹ "${l}(${e})" æœç´¢ä¾‹å­—, cachedCheckedCount=${Q.value}...`);const u=new Promise((d,w)=>{setTimeout(()=>w(new Error("æ•¸æ“šåŠ è¼‰è¶…æ™‚")),1e4)}),n=await Promise.race([B.value.loadData(),u]),p=Object.entries(n).slice(0,3);console.log("æ•¸æ“šæ¨£æœ¬:",p);let a=0;for(const[d,w]of Object.entries(n).slice(Q.value)){a++;const q=w;if(a<=5&&console.log(`å­—ç¬¦ "${d}" çš„æ‹†åˆ†æ•¸æ“š:`,q.d),q.d){for(const X of q.d){F.value.has(X)||F.value.set(X,new Set);const te=F.value.get(X);te.size<20&&te.add(d),X===e&&(r=te,console.log(`âœ… æ‰¾åˆ°åŒ¹é…: "${d}" åŒ…å«å­—æ ¹ "${e}", æ‹†åˆ†: "${q.d}"`))}if(r.size>=20)break}a%1e3===0&&console.log(`å·²æª¢æŸ¥ ${a} å€‹å­—ç¬¦ï¼Œæ‰¾åˆ° ${r.size} å€‹ä¾‹å­—`)}return Q.value+=a,console.log(`å­—æ ¹ "${e}" æœ€çµ‚æ‰¾åˆ°ä¾‹å­—:`,Array.from(r).slice(0,5),`(ç¸½å…±${r.size}å€‹)`),Array.from(r)}catch(u){return console.error("ç²å–ä¾‹å­—å¤±æ•—:",u),u instanceof Error&&u.message==="æ•¸æ“šåŠ è¼‰è¶…æ™‚"&&console.error("æ•¸æ“šåŠ è¼‰è¶…æ™‚ï¼Œè«‹æª¢æŸ¥ç¶²çµ¡é€£æ¥"),Array.from(r)}},ee=async l=>{const e=l.normalize("NFC");let r=new Set;if(!(c.searchExamplesFromChaifen!==!1)){if(!x.value)return console.log("zigenMap æœªåˆå§‹åŒ–"),[];for(const[u,n]of x.value)if(n.font===e&&n.examples){const p=n.examples.split(/[,\s]+/).filter(a=>a.length>0);return r=new Set(p),console.log(`âœ… å¾ zigen æ•¸æ“šç²å–å­—æ ¹ "${e}" çš„æ‰€æœ‰ä¾‹å­— ${r.size} å€‹`),Array.from(r)}return console.log(`æœªåœ¨ zigen æ•¸æ“šä¸­æ‰¾åˆ°å­—æ ¹ "${e}" çš„ä¾‹å­—`),[]}if(!B.value)return console.log("chaifenLoader æœªåˆå§‹åŒ–"),[];try{console.log(`é–‹å§‹ç‚ºå­—æ ¹ "${l}" æœç´¢æ‰€æœ‰ä¾‹å­—...`);const u=new Promise((p,a)=>{setTimeout(()=>a(new Error("æ•¸æ“šåŠ è¼‰è¶…æ™‚")),3e4)}),n=await Promise.race([B.value.loadData(),u]);for(const[p,a]of Object.entries(n)){const d=a;d.d&&d.d.includes(e)&&r.add(p)}return console.log(`å­—æ ¹ "${e}" æ‰¾åˆ°æ‰€æœ‰ä¾‹å­—: ${r.size} å€‹`),Array.from(r)}catch(u){return console.error("ç²å–æ‰€æœ‰ä¾‹å­—å¤±æ•—:",u),Array.from(r)}};async function me(){H.value=!0;try{const l=ce(E.value),e=await Le(l.zigenUrl);x.value=e,console.log("æˆ‘å°±çŸ¥é“ä½ æœƒå¿ä¸ä½æ‰“é–‹æ§åˆ¶è‡ºğŸ˜"),console.log(`å·²åŠ è¼‰å­—æ ¹æ•¸æ“šï¼Œæ–‡ä»¶: ${l.zigenUrl}`),console.log("æ³¨æ„ï¼šæ‹†åˆ†æ•¸æ“šå°‡åœ¨ç¬¬ä¸€æ¬¡é»æ“Šå­—æ ¹æ™‚æ‰åŠ è¼‰")}catch(l){console.error("åŠ è¼‰å­—æ ¹æ•¸æ“šå¤±æ•—:",l)}finally{H.value=!1}}function de(l){switch(l){case";":return"æ¬¡é¸";case",":return"é€—è™Ÿ";case".":return"å¥è™Ÿ";default:return"æ— å­—æ ¹"}}function j(l){return c.customEmptyKeyLabels&&c.customEmptyKeyLabels[l]||null}async function ve(l,e){var p;if(l.stopPropagation(),!B.value){console.log("é»æ“Šæ™‚åˆå§‹åŒ–æ‹†åˆ†æ•¸æ“šåŠ è¼‰å™¨...");const a=ce(E.value);B.value=Te.getInstance(a.chaifenUrl),console.log(`å·²åˆå§‹åŒ– ChaiDataLoaderï¼Œä½¿ç”¨æ–‡ä»¶: ${a.chaifenUrl}`)}if(y.value&&W.value===e.font){pe();return}W.value=e.font,y.value=!0;let r="";if(x.value){for(const[a,d]of x.value)if(d.font===e.font&&((p=d.ma)==null?void 0:p.slice(1))===e.code){r=d.ma;break}}const t=we(e.font,r);f.value=t,console.log("é–‹å§‹ç²å–ä¾‹å­—ï¼Œå­—æ ¹æ•¸é‡:",[...t.visible,...t.hidden].length);const u={},n=[...t.visible,...t.hidden];for(const a of n){console.log(`æ­£åœ¨ç²å–å­—æ ¹ "${a.font}" çš„ä¾‹å­—...`);const d=await ue(a.font);console.log(`å­—æ ¹ "${a.font}" æ‰¾åˆ°ä¾‹å­—:`,d.length,"å€‹"),u[a.font]=d}h.value=u,console.log(`å›ºå®šå½ˆçª— - å­—æ ¹ "${e.font}" çš„æœ€çµ‚ä¾‹å­—:`,h.value)}function pe(){y.value=!1,W.value=null,f.value=null,h.value={},Z.value.clear()}async function ge(l){var e;if(Z.value.has(l))Z.value.delete(l);else if(Z.value.add(l),((e=h.value[l])==null?void 0:e.length)<=ae){console.log(`æ­£åœ¨åŠ è¼‰å­—æ ¹ "${l}" çš„æ‰€æœ‰ä¾‹å­—...`);const r=await ee(l);h.value[l]=r,console.log(`å·²åŠ è¼‰å­—æ ¹ "${l}" çš„ ${r.length} å€‹ä¾‹å­—`)}}async function he(){if(!T.value){T.value=!0,m.value="";try{const l=document.querySelector(".zigen-map-container");if(!l)throw new Error("æ‰¾ä¸åˆ°å­—æ ¹åœ–å®¹å™¨å…ƒç´ ");y.value&&pe(),await new Promise(t=>setTimeout(t,100));const e=c.schemeCnName||ke.getSchemeDisplayName(E.value),r=await ke.exportZigenMapToPNG(l,e,k.value,{copyToClipboard:!1,download:!0,scale:3,addWatermark:!0,customFooter:c.customFooter});r.success?(m.value=r.message,setTimeout(()=>{m.value=""},3e3)):(m.value=r.message,setTimeout(()=>{m.value=""},5e3))}catch(l){console.error("å°å‡ºå­—æ ¹åœ–å¤±æ•—:",l),m.value=`å°å‡ºå¤±æ•—: ${l instanceof Error?l.message:"æœªçŸ¥éŒ¯èª¤"}`,setTimeout(()=>{m.value=""},5e3)}finally{T.value=!1}}}function ye(l,e){return e&&Y.value.includes(e)?!0:["ling","ming"].includes(E.value)?l.length===1:!1}function we(l,e){var u,n;const r=[],t=[];if(!x.value||!e)return{visible:r,hidden:t};for(const[p,a]of x.value){const d=a.font,w=(u=a.ma)==null?void 0:u.trim(),q=(n=a.pinyin)==null?void 0:n.trim();!w||!d||d===null||d===void 0||w===e&&(d===l?r.unshift({font:d,code:w,pinyin:q}):t.push({font:d,code:w,pinyin:q}))}return{visible:r,hidden:t}}return _e(()=>E.value,me),xe(()=>{me(),document.addEventListener("click",l=>{if(y.value){const e=document.querySelector(".pinned-popup");e&&!e.contains(l.target)&&pe()}})}),(l,e)=>{var r;return s(),o("div",Ze,[H.value?(s(),o("div",De,[...e[0]||(e[0]=[i("div",{class:"loading loading-spinner loading-lg"},null,-1),i("span",{class:"ml-2"},"æ­£åœ¨åŠ è¼‰å­—æ ¹æ•¸æ“š...",-1)])])):C("",!0),H.value?C("",!0):(s(),o("div",Me,[e[7]||(e[7]=i("div",{class:"text-sm text-gray-500 dark:text-gray-400"}," é»æ“Šå­—æ ¹å¯æŸ¥çœ‹ä¾‹å­— ",-1)),b.value?C("",!0):(s(),o("div",Ne,[i("div",Pe,[i("button",{onClick:he,class:_(["export-btn layout-toggle-btn",{"layout-toggle-active":T.value}]),disabled:T.value,title:T.value?"å°å‡ºä¸­...":"å°å‡ºå­—æ ¹åœ–"},[T.value?(s(),o("span",Be,"â³")):(s(),o("span",Ke,"ğŸ“¸"))],10,qe),m.value?(s(),o("span",{key:0,class:_(["text-xs",m.value.includes("å¤±æ•—")?"text-red-500":"text-green-500"])},g(m.value),3)):C("",!0)]),i("div",Fe,[e[1]||(e[1]=i("span",{class:"text-xs text-gray-400"},"ç·¨ç¢¼é•·åº¦",-1)),i("button",{onClick:K,class:_(["layout-toggle-btn",{"layout-toggle-active":z.value}]),title:z.value?"æ¢å¾©åŸå§‹é †åº":"çŸ­ç·¨ç¢¼å„ªå…ˆï¼ˆ2ç¢¼â†’3ç¢¼ï¼‰"},[z.value?(s(),o("span",Ue,"ğŸ“")):(s(),o("span",je,"ğŸ”¢"))],10,We)]),k.value?(s(),o("div",Re,[e[2]||(e[2]=i("span",{class:"text-xs text-gray-400"},"æŒ‰éµæ’åº",-1)),i("button",{onClick:M,class:_(["layout-toggle-btn",{"layout-toggle-active":L.value}]),title:L.value?"åˆ‡æ›ç‚ºéµç›¤é †åº":"åˆ‡æ›ç‚ºå­—æ¯é †åº"},[L.value?(s(),o("span",He,"ğŸ”¤")):(s(),o("span",Ie,"âŒ¨ï¸"))],10,Ve)])):C("",!0),k.value?C("",!0):(s(),o("div",Oe,[e[3]||(e[3]=i("span",{class:"text-xs text-gray-400"},"é¡¯ç¤ºæ¨¡å¼",-1)),i("button",{onClick:le,class:_(["layout-toggle-btn",{"layout-toggle-active":P.value}]),title:P.value?"éš±è—é‡ç¢¼å­—æ ¹":"é¡¯ç¤ºæ‰€æœ‰å­—æ ¹"},[P.value?(s(),o("span",Ge,"ğŸ‘ï¸â€ğŸ—¨ï¸")):(s(),o("span",Xe,"ğŸ‘ï¸"))],10,Qe)])),i("div",Ye,[e[4]||(e[4]=i("span",{class:"text-xs text-gray-400"},"åˆ‡æ›åœ–è¡¨å½¢æ…‹",-1)),i("button",{onClick:ne,class:_(["layout-toggle-btn",{"layout-toggle-active":k.value}]),title:k.value?"åˆ‡æ›ç‚ºç¶²æ ¼å¸ƒå±€":"åˆ‡æ›ç‚ºåˆ—è¡¨å¸ƒå±€"},[k.value?(s(),o("span",tt,"âŠ")):(s(),o("span",et,"â˜°"))],10,Je)])])),b.value?(s(),o("div",st,[i("button",{onClick:he,class:_(["export-btn layout-toggle-btn",{"layout-toggle-active":T.value}]),disabled:T.value,title:T.value?"å°å‡ºä¸­...":"å°å‡ºå­—æ ¹åœ–"},[T.value?(s(),o("span",lt,"â³")):(s(),o("span",nt,"ğŸ“¸"))],10,ot),e[5]||(e[5]=i("span",{class:"text-xs text-gray-400"},"æŒ‰éµæ’åº",-1)),i("button",{onClick:M,class:_(["layout-toggle-btn",{"layout-toggle-active":L.value}]),title:L.value?"åˆ‡æ›ç‚ºéµç›¤é †åº":"åˆ‡æ›ç‚ºå­—æ¯é †åº"},[L.value?(s(),o("span",it,"ğŸ”¤")):(s(),o("span",rt,"âŒ¨ï¸"))],10,at),e[6]||(e[6]=i("span",{class:"text-xs text-gray-400"},"ç·¨ç¢¼é•·åº¦",-1)),i("button",{onClick:K,class:_(["layout-toggle-btn",{"layout-toggle-active":z.value}]),title:z.value?"æ¢å¾©åŸå§‹é †åº":"çŸ­ç·¨ç¢¼å„ªå…ˆï¼ˆ2ç¢¼â†’3ç¢¼ï¼‰"},[z.value?(s(),o("span",dt,"ğŸ“")):(s(),o("span",ut,"ğŸ”¢"))],10,ct)])):C("",!0),b.value&&m.value?(s(),o("div",pt,[i("span",{class:_(["text-xs",m.value.includes("å¤±æ•—")?"text-red-500":"text-green-500"])},g(m.value),3)])):C("",!0)])),!H.value&&x.value&&!b.value&&!k.value?(s(),o("div",ft,[(s(),o(U,null,R(se,(t,u)=>i("div",{key:u,class:"keyboard-row"},[(s(!0),o(U,null,R(t,n=>{var p;return s(),o("div",{key:n,class:_(["keyboard-key",{"empty-key":S.includes(n)}])},[i("div",mt,g(n.toUpperCase()),1),!S.includes(n)&&((p=v.value[n])==null?void 0:p.visible.length)>0?(s(),o("div",{key:0,class:"zigen-list text-indigo-800 dark:text-indigo-300",style:ze({gridTemplateColumns:J.value})},[(s(!0),o(U,null,R(z.value?[...P.value?v.value[n].all:v.value[n].all.filter(a=>!a.isHidden)].sort((a,d)=>a.code.length-d.code.length):P.value?v.value[n].all:v.value[n].all.filter(a=>!a.isHidden),(a,d)=>(s(),o("span",{key:d,class:_(["zigen-item",{"small-root-zigen":ye(a.code,a.font)}]),onClick:w=>ve(w,a)},[i("span",{class:_(A.value)},g(a.font),3),i("span",gt,g(a.code),1)],10,vt))),128)),!P.value&&v.value[n].hidden.length>0?(s(),o("span",ht,"â‹¯")):C("",!0)],4)):S.includes(n)?C("",!0):(s(),o("div",yt,[j(n)?(s(),o("div",xt,[Array.isArray(j(n))?(s(),o("div",_t,[(s(!0),o(U,null,R(j(n),(a,d)=>(s(),o("div",{key:d},g(a),1))),128))])):(s(),o("div",bt,g(j(n)),1))])):n==="/"?(s(),o("div",kt,[...e[8]||(e[8]=[i("div",null,"å¼•å°ç‰¹æ®Šç¬¦è™Ÿ",-1),i("div",null,"åˆ‡æ›å¤šé‡è¨»è§£",-1)])])):n==="z"?(s(),o("div",wt,[...e[9]||(e[9]=[i("div",null,"å¼•å°æ‹¼éŸ³åæŸ¥",-1),i("div",null,"å¼•å°æ­·å²è¼¸å…¥",-1)])])):n==="a"?(s(),o("div",Ct,[...e[10]||(e[10]=[i("div",null,null,-1),i("div",null,"ä¸€ç¢¼ä¸Šå±å­—ã€€äº†",-1)])])):n==="e"?(s(),o("div",St,[...e[11]||(e[11]=[i("div",null,null,-1),i("div",null,"ä¸€ç¢¼ä¸Šå±å­—ã€€çš„",-1)])])):n==="i"?(s(),o("div",zt,[...e[12]||(e[12]=[i("div",null,null,-1),i("div",null,"ä¸€ç¢¼ä¸Šå±å­—ã€€æ˜¯",-1)])])):n==="o"?(s(),o("div",Et,[...e[13]||(e[13]=[i("div",null,null,-1),i("div",null,"ä¸€ç¢¼ä¸Šå±å­—ã€€æˆ‘",-1)])])):n==="u"?(s(),o("div",$t,[...e[14]||(e[14]=[i("div",null,null,-1),i("div",null,"ä¸€ç¢¼ä¸Šå±å­—ã€€ä¸",-1)])])):(s(),o("div",Lt,g(de(n)),1))]))],2)}),128))])),64))])):C("",!0),!H.value&&x.value&&(b.value||k.value)?(s(),o("div",{key:3,class:_(["mobile-layout",{"desktop-list-layout":!b.value&&k.value}])},[(s(!0),o(U,null,R(V.value,t=>{var u;return s(),o("div",{key:t,class:_(["mobile-key-row",{"empty-mobile-key":S.includes(t)}])},[i("div",Tt,g(t.toUpperCase()),1),!S.includes(t)&&((u=N.value[t])==null?void 0:u.length)>0?(s(),o("div",At,[i("div",Zt,[(s(!0),o(U,null,R(N.value[t],(n,p)=>(s(),o("span",{key:`sorted-${p}`,class:_(["mobile-zigen-item",{"mobile-hidden-zigen":n.isHidden,"mobile-small-root-zigen":!n.isHidden&&ye(n.code,n.font)}]),onClick:a=>ve(a,n)},[i("span",{class:_(A.value)},g(n.font),3),i("span",Mt,g(n.code),1)],10,Dt))),128))])])):S.includes(t)?C("",!0):(s(),o("div",Nt,[j(t)?(s(),o("span",Pt,g(Array.isArray(j(t))?j(t)[0]:j(t)),1)):t==="/"?(s(),o("span",qt,"å¼•å°ç‰¹æ®Šç¬¦è™Ÿ")):t==="z"?(s(),o("span",Kt,"å¼•å°æ‹¼éŸ³åæŸ¥")):["a","e","i","o","u"].includes(t)?(s(),o("span",Bt," ä¸€ç¢¼ä¸Šå±å­— ")):(s(),o("span",Ft,g(de(t)),1))]))],2)}),128))],2)):C("",!0),y.value&&W.value&&f.value?(s(),o("div",Wt,[i("div",jt,[i("div",Ut,[i("div",Rt,[i("h3",Vt," ç·¨ç¢¼ "+g(((r=f.value.visible[0])==null?void 0:r.code)||W.value)+" ä¸Šçš„å­—æ ¹ ",1),i("button",{onClick:pe,class:"close-btn"},"âœ•")]),i("div",Ht,[(s(!0),o(U,null,R(f.value.visible,(t,u)=>{var n;return s(),o("div",{key:`pinned-visible-${u}`,class:"zigen-row-wrapper"},[i("div",It,[i("div",Ot,[i("span",{class:_(A.value)},g(t.font),3)]),((n=h.value[t.font])==null?void 0:n.length)>0?(s(),o("div",Qt,[(s(!0),o(U,null,R(Z.value.has(t.font)?h.value[t.font]:h.value[t.font].slice(0,ae),p=>(s(),o("span",{key:p,class:"example-char zigen-font"},g(p),1))),128)),i("button",{onClick:be(p=>ge(t.font),["stop"]),class:"example-char expand-btn",type:"button",title:Z.value.has(t.font)?"æ”¶èµ·":"å±•é–‹é¡¯ç¤ºæ‰€æœ‰ä¾‹å­—"},g(Z.value.has(t.font)?"â–²":"â–¼"),9,Xt)])):ie.searchExamplesFromChaifen!==!1?(s(),o("div",Gt,[...e[15]||(e[15]=[i("span",{class:"loading-text"},"æ­£åœ¨åŠ è¼‰...",-1)])])):C("",!0)]),t.pinyin?(s(),o("div",Yt,g(t.pinyin),1)):C("",!0)])}),128)),(s(!0),o(U,null,R(f.value.hidden,(t,u)=>{var n;return s(),o("div",{key:`pinned-hidden-${u}`,class:"zigen-row-wrapper"},[i("div",Jt,[i("div",es,[i("span",{class:_(A.value)},g(t.font),3)]),((n=h.value[t.font])==null?void 0:n.length)>0?(s(),o("div",ts,[(s(!0),o(U,null,R(Z.value.has(t.font)?h.value[t.font]:h.value[t.font].slice(0,ae),p=>(s(),o("span",{key:p,class:"example-char zigen-font"},g(p),1))),128)),i("button",{onClick:be(p=>ge(t.font),["stop"]),class:"example-char expand-btn",type:"button",title:Z.value.has(t.font)?"æ”¶èµ·":"å±•é–‹é¡¯ç¤ºæ‰€æœ‰ä¾‹å­—"},g(Z.value.has(t.font)?"â–²":"â–¼"),9,ss)])):ie.searchExamplesFromChaifen!==!1?(s(),o("div",os,[...e[16]||(e[16]=[i("span",{class:"loading-text"},"æ­£åœ¨åŠ è¼‰...",-1)])])):C("",!0)]),t.pinyin?(s(),o("div",ns,g(t.pinyin),1)):C("",!0)])}),128))])])])])):C("",!0)])}}}),cs=$e(ls,[["__scopeId","data-v-94b62554"]]);export{cs as Z};
