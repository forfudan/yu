var B=Object.defineProperty;var F=(r,s,t)=>s in r?B(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t;var x=(r,s,t)=>(F(r,typeof s!="symbol"?s+"":s,t),t);import{d as I,H as m,l as M,y as N,o as d,c as h,m as o,t as u,n as y,b as A,e as b,p as T,ai as j,aj as z,a as w}from"./framework.vM2YJXtg.js";import{_ as E}from"./MultiChaifen.vue_vue_type_script_setup_true_lang.0AhTLj5f.js";function V(r,s){let t="",e=0;for(const n of s.values())if(n.division.includes(r)&&(t+=n.char,e++,e>=8))break;return t}function O(r,s){let t=null;return()=>{t||(t=setTimeout(()=>{r(),t=null},s))}}class C{constructor(s,t=""){x(this,"record");x(this,"progress",0);x(this,"saveLocal",O(()=>{window.localStorage.setItem(`yuhao_${this.name}_records`,JSON.stringify(this.record))},1e3));this.items=s,this.name=t;const e=window.localStorage.getItem(`yuhao_${this.name}_records`);e?this.record=JSON.parse(e):this.record=Array.from({length:this.items.length},(l,c)=>[-1,c]);let n=0;for(const l of this.record)l[0]!==-1&&++n;this.progress=n}first(){return{item:this.items[this.record[0][1]],isFirst:this.record[0][0]===-1}}nextSuccess(){const s=this.record.length-1,t=this.record[0],e=++t[0];e===0&&this.progress===t[1]&&this.progress++;let n=0;const l=[4,16,64,256];return e>l.length-1?(t[0]=8,n=s):(n=l[e],n>s&&(n=s)),this.record.copyWithin(0,1,n+1),this.record[n]=t,this.saveLocal(),this.first()}nextFail(){return this.record[0][0]=-1,this.saveLocal(),this.first()}}const R={key:0,class:"text-center py-16"},$={class:"mb-8"},D=o("div",{class:"text-6xl mb-4"},"ğŸ‰",-1),J=o("h2",{class:"text-4xl font-bold mb-2"},"æ­å–œä½ å®Œæˆç·´ç¿’ï¼",-1),U={class:"text-xl text-gray-600 mb-8"},H=o("div",{class:"text-sm text-gray-500"}," ç¹¼çºŒç·´ç¿’ä»¥å·©å›ºè¨˜æ†¶ ",-1),P={key:1},W={class:"flex justify-center mb-24"},q=["value","max"],G={class:"flex justify-around mb-8"},Q={key:0,class:"flex tracking-widest flex-col opacity-70"},X={key:1,class:"flex tracking-widest flex-col opacity-70"},Y=o("div",{class:"text-gray-500 text-sm"}," ç›¸å…³çš„å­—ï¼š ",-1),Z={class:"font-bold text-xl"},K={class:"flex justify-center p-5"},ee={class:"font-mono"},te={key:0},se={key:1,class:"text-sm text-gray-500 mt-1"},ae={class:"font-mono text-blue-600"},oe={class:"text-gray-500 pb-16"},le=I({__name:"TrainCard",props:{cards:{},name:{},chaifenMap:{},mode:{},supplement:{type:Boolean},ming:{type:Boolean}},setup(r){const s=r;let t;const e=m({name:"",key:""}),n=m(0),l=m(!0),c=m(!0),k=m(!1),g=m("");M(()=>{t=new C(s.cards,s.name);const a=t.first();e.value=a.item,l.value=a.isFirst,n.value=t.progress;const i=document.getElementById("input_el");i==null||i.focus()}),N(g,a=>{const i={çš„:"e",æ˜¯:"i",æˆ‘:"o",ä¸:"u",äº†:"a"};(a.length>=e.value.key.length||s.ming&&i[e.value.name]&&a.toLowerCase()===i[e.value.name])&&(S(a),g.value="")});function S(a){const i=a.toLowerCase(),v=e.value.key.toLowerCase(),f={çš„:"e",æ˜¯:"i",æˆ‘:"o",ä¸:"u",äº†:"a"};let p=i===v;!p&&s.ming&&f[e.value.name]&&(p=i===f[e.value.name]);let _;if(p?(_=t.nextSuccess(),c.value=!0):(_=t.nextFail(),c.value=!1),n.value>=s.cards.length){k.value=!0;return}e.value=_.item,l.value=_.isFirst,n.value=t.progress}function L(){t=new C(s.cards,s.name);const a=t.first();e.value=a.item,l.value=a.isFirst,n.value=t.progress,k.value=!1;const i=document.getElementById("input_el");i==null||i.focus()}return(a,i)=>{var v,f;return k.value?(d(),h("div",R,[o("div",$,[D,J,o("p",U,"ä½ å·²ç»å®Œæˆäº† "+u(a.cards.length)+" å€‹é …ç›®çš„ç·´ç¿’ï¼Œç²å¾—ç§°å·ã€Œç™»å ‚å…¥å®¤ã€",1)]),o("div",{class:"space-y-4"},[o("button",{onClick:L,class:"btn btn-primary btn-lg px-8"}," è¦ä¸è¦å†ä¾†ä¸€è¼ªï¼Ÿ "),H])])):(d(),h("div",P,[o("div",{class:y(["md:w-2/3 w-full shadow-sm my-12 pb-24 bg-opacity-10  rounded-md",{"bg-red-700":!c.value,"bg-slate-500":c.value}])},[o("div",W,[o("progress",{class:"progress w-full",value:n.value,max:a.cards.length},null,8,q)]),o("div",G,[o("div",{class:y(["text-6xl ",{"text-red-400":!c.value}])},u(e.value.name),3),a.mode==="z"?(d(),h("div",Q,[(d(),A(E,{chars:e.value.name,size:100,key:e.value.name,loc:""},null,8,["chars"]))])):b("",!0),a.mode==="g"&&a.chaifenMap?(d(),h("div",X,[Y,o("div",Z,u(T(V)(e.value.name,a.chaifenMap)),1)])):b("",!0)]),o("div",K,[j(o("input",{id:"input_el",type:"text",placeholder:"è¼¸å…¥ç·¨ç¢¼","onUpdate:modelValue":i[0]||(i[0]=p=>g.value=p),class:y(["input w-half max-w-xs input-bordered text-center input-sm dark:bg-slate-800 bg-white",{"input-error":!c.value}])},null,2),[[z,g.value]])]),o("div",{class:y(["text-center",{"opacity-0":!l.value}])},[w("ç­”æ¡ˆæ˜¯ "),o("b",ee,u(e.value.key),1),a.mode==="z"?(d(),h("span",te,"ï¼ˆ"+u((f=(v=a.chaifenMap)==null?void 0:v.get(e.value.name))==null?void 0:f.division)+"ï¼‰",1)):b("",!0),s.ming&&["çš„","æ˜¯","æˆ‘","ä¸","äº†"].includes(e.value.name)?(d(),h("div",se,[w(" ä¹Ÿå¯ç›´æ¥ä½¿ç”¨éŸ»ç¢¼ "),o("b",ae,u(e.value.name==="çš„"?"E":e.value.name==="æ˜¯"?"I":e.value.name==="æˆ‘"?"O":e.value.name==="ä¸"?"U":e.value.name==="äº†"?"A":""),1),w(" ç›´æ¥ä¸Šå± ")])):b("",!0)],2)],2),o("div",oe,"è¨“ç·´é€²åº¦ï¼š"+u(n.value)+" / "+u(a.cards.length),1)]))}}});export{le as _};
