import{d as b,H as r,k as C,y as f,l as I,o as i,c as u,m as o,ag as V,ah as $,a as L,t as w,e as k,b as S}from"./framework.rq0FYgLR.js";import{_ as T}from"./Search.vue_vue_type_script_setup_true_lang.DJcqL1vg.js";import{f as E}from"./share.Nrbaa2_l.js";import{C as F}from"./ChaiDataLoader.DYi6iwdM.js";const N={class:"input input-bordered bg-gray-100 dark:bg-slate-800 flex items-center gap-2 mt-2"},Z=o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"h-4 w-4 opacity-70"},[o("path",{"fill-rule":"evenodd",d:"M9.965 11.026a5 5 0 1 1 1.06-1.06l2.755 2.754a.75.75 0 1 1-1.06 1.06l-2.755-2.754ZM10.5 7a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Z","clip-rule":"evenodd"})],-1),j={key:0,class:"text-gray-600 text-center py-4"},O=o("div",{class:"loading loading-spinner loading-sm mr-2"},null,-1),P={key:1,class:"alert alert-error mt-2"},H=o("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),R={key:3,class:"opacity-40 text-center p-9 tracking-widest"},q={key:4,class:"text-gray-500 text-center py-4"},Q=b({__name:"OptimizedFetchSearch",props:{chaifenUrl:{},zigenUrl:{},supplement:{type:Boolean},ming:{type:Boolean},modelValue:{}},emits:["update:modelValue"],setup(x,{emit:M}){const l=x,z=M,m=r(),p=r(),n=r(!1),s=r(!1),t=r(l.modelValue||""),c=r(null),_=["å°æ¨“ä¸€å¤œè½æ˜¥é›¨ã€€æ·±å··æ˜Žæœè³£æèŠ±","ä¼‘å°æ•…äººæ€æ•…åœ‹ã€€ä¸”å°‡æ–°ç«è©¦æ–°èŒ¶","ä¸‰ååŠŸåå¡µèˆ‡åœŸã€€å…«åƒé‡Œè·¯é›²å’Œæœˆ","è½èŠ±äººç¨ç«‹ã€€å¾®é›¨ç‡•é›™é£›","çŽ²ç“éª°å­å®‰ç´…è±†ã€€å…¥éª¨ç›¸æ€çŸ¥ä¸çŸ¥","å…©æƒ…è‹¥æ˜¯ä¹…é•·æ™‚ã€€åˆè±ˆåœ¨æœæœæš®æš®","èº«ç„¡å½©é³³é›™é£›ç¿¼ã€€å¿ƒæœ‰éˆçŠ€ä¸€é»žé€š","è‡ªåœ¨é£›èŠ±è¼•ä¼¼å¤¢ã€€ç„¡é‚Šçµ²é›¨ç´°å¦‚æ„","é†‰å¾Œä¸çŸ¥å¤©åœ¨æ°´ã€€æ»¿èˆ¹æ¸…å¤¢å£“æ˜Ÿæ²³","æ±é¢¨å¤œæ”¾èŠ±åƒæ¨¹ã€€æ›´å¹è½ã€€æ˜Ÿå¦‚é›¨","é³³è•­è²å‹•ã€€çŽ‰å£¸å…‰è½‰ã€€ä¸€å¤œé­šé¾èˆž","çˆ²å›æŒé…’å‹¸æ–œé™½ã€€ä¸”å‘èŠ±é–“ç•™æ™šç…§","ç¶ æ¥Šç…™å¤–æ›‰å¯’è¼•ã€€ç´…ææžé ­æ˜¥æ„é¬§","åŸŽä¸­æ¡ƒæŽæ„é¢¨é›¨ã€€æ˜¥åœ¨æºªé ­è–ºèœèŠ±","æœªæ˜¯ç§‹å…‰å¥‡ç»ã€€çœ‹åäº”åå…­","ç„¡å¯å¥ˆä½•èŠ±è½åŽ»ã€€ä¼¼æ›¾ç›¸è­˜ç‡•æ­¸ä¾†","ä½†é¡˜äººé•·ä¹…ã€€åƒé‡Œå…±å¬‹å¨Ÿ","å¤§æ±Ÿæ±åŽ»ã€€æµªæ·˜ç›¡åƒå¤é¢¨æµäººç‰©","æ˜Žæœˆå¹¾æ™‚æœ‰ã€€æŠŠé…’å•é’å¤©","ä¸€è“‘ç…™é›¨ä»»å¹³ç”Ÿã€€ä¹Ÿç„¡é¢¨é›¨ä¹Ÿç„¡æ™´","ç¸±è±†è”»è©žå·¥ã€€é’æ¨“å¤¢å¥½ã€€é›£è³¦æ·±æƒ…","è¡£å¸¶æ¼¸å¯¬çµ‚ä¸æ‚”ã€€ç‚ºä¼Šæ¶ˆå¾—äººæ†”æ‚´"],D=C(()=>{const e=Math.floor(Math.random()*_.length);return _[e]});f(()=>l.modelValue,e=>{e!==void 0&&e!==t.value&&(t.value=e,e.trim().length>0&&!s.value&&v())},{immediate:!0}),f(t,e=>{z("update:modelValue",e),e.trim().length>0&&!s.value&&v()}),f([s,t],([e,a])=>{e&&a&&a.trim().length>0&&console.log(`ðŸ” Data loaded, ready to search for: "${a}"`)});const B=F.getInstance(l.chaifenUrl);async function v(){if(s.value||n.value)return;n.value=!0,c.value=null;const e=performance.now();try{const[a,d]=await Promise.all([B.loadData(),E(l.zigenUrl)]),g=new Map;for(const[y,h]of Object.entries(a))g.set(y,{char:y,division:h.d||"",division_tw:h.dt||"",region:h.r||""});m.value=g,p.value=d,s.value=!0;const U=performance.now()-e;console.log(`ðŸš€ Search data loaded in ${U.toFixed(2)}ms`),console.log(`ðŸ“¦ Characters: ${g.size}`),console.log(`ðŸ“ Source: ${l.chaifenUrl}`)}catch(a){console.error("Failed to load search data:",a),c.value=a instanceof Error?a.message:"Unknown error"}finally{n.value=!1}}return I(()=>{t.value.trim().length>0&&v()}),(e,a)=>(i(),u("div",null,[o("label",N,[V(o("input",{"onUpdate:modelValue":a[0]||(a[0]=d=>t.value=d),type:"text",class:"grow",placeholder:"è¼¸å…¥æ¼¢å­—æŸ¥è©¢æ‹†åˆ†å’Œç·¨ç¢¼"},null,512),[[$,t.value]]),Z]),n.value?(i(),u("div",j,[O,L(" æ­£åœ¨åŠ è½½æ‹†åˆ†æ•°æ®â€¦â€¦ ")])):c.value?(i(),u("div",P,[H,o("span",null,"åŠ è½½å¤±è´¥ï¼š"+w(c.value),1)])):k("",!0),s.value&&m.value&&p.value?(i(),S(T,{key:2,chaifenMap:m.value,zigenMap:p.value,supplement:l.supplement,ming:l.ming||!1,userInput:t.value,"onUpdate:userInput":a[1]||(a[1]=d=>t.value=d)},null,8,["chaifenMap","zigenMap","supplement","ming","userInput"])):!t.value.trim()&&!n.value&&!c.value?(i(),u("div",R,w(D.value),1)):t.value.trim().length>0&&!n.value?(i(),u("div",q," å¼€å§‹è¾“å…¥ä»¥æŸ¥çœ‹æ‹†åˆ†â€¦â€¦ ")):k("",!0)]))}});export{Q as _};
