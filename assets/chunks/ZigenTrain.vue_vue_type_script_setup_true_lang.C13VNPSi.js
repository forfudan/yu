import{c as ue,f as ie}from"./share.DnuYRLaV.js";import{A as te}from"./advancedSchedule.ChzbWpT_.js";import{d as ae,h as c,l as J,R as A,aa as X,k as L,v as de,c as l,o as u,F as Y,e as M,m as a,t as C,p as B,n as o,O as ce,C as ge,a3 as ve,a4 as fe,a as ee,a0 as pe,a2 as xe,_ as me,E as H,H as ye}from"./framework.D5VGNaZP.js";import{f as he}from"./share.BaGPHDUM.js";const be={key:0,class:"text-center py-16"},ke={class:"mb-8"},we={class:"text-xl text-gray-600 dark:text-gray-400 mb-8"},Ce={class:"relative"},Se={key:0,class:"text-red-600 dark:text-red-400"},ze=["title"],_e={class:"flex items-center gap-1"},$e={class:"flex items-center gap-1"},Be={key:1,class:"text-blue-600 dark:text-blue-400 font-medium"},Te=ae({__name:"TrainCardGroup",props:{name:{},cardGroups:{},chaifenMap:{},mode:{},supplement:{type:Boolean},ming:{type:Boolean},isFrequencyOrder:{type:Boolean},onToggleSort:{type:Function},onReset:{type:Function}},setup(V){const g=V,{name:E,cardGroups:m,mode:W,supplement:p,ming:O,isFrequencyOrder:S,onToggleSort:T,onReset:I}=g;console.log(`è¼‰å…¥åˆ†çµ„ç·´ç¿’æœƒè©±: ${E}`);const y=new te(E),z=c(0),j=c(),k=c(""),x=c(!1),h=c(!0),F=c(0),_=c(!1),G=c(0),Z=c(!1);c(10);const r=c([]);c(0);const s=c(0);c(2e3);const i=()=>{_.value=!0},$=()=>{I&&(I(),_.value=!1,setTimeout(()=>{window.location.reload()},100))},b=()=>{_.value=!1},e=c(typeof window<"u"?window.innerWidth:1024),w=()=>{e.value=window.innerWidth};J(()=>{typeof window<"u"&&window.addEventListener("resize",w),A(()=>{var t;(t=j.value)==null||t.focus()}),document.addEventListener("keydown",U),N()}),X(()=>{typeof window<"u"&&window.removeEventListener("resize",w),document.removeEventListener("keydown",U)});const d=L(()=>{if(!f.value)return"text-8xl";const t=f.value.zigens.length,n=e.value<768,v=e.value<1024;return n?t<=2?"text-6xl":t<=4?"text-5xl":"text-4xl":v?t<=2?"text-8xl":t<=4?"text-7xl":"text-6xl":t<=2?"text-9xl":t<=4?"text-8xl":"text-7xl"}),R=L(()=>{if(!f.value)return"gap-8 lg:gap-12";const t=f.value.zigens.length;return e.value<768?t>4?"gap-1":t>2?"gap-2":"gap-3":t>4?"gap-6":"gap-8 lg:gap-12"}),f=L(()=>m[z.value]||null);L(()=>m.length);const q=L(()=>{G.value;const t=y.getProgressStats();return{current:t.practiced,total:t.total,mastered:t.mastered,percentage:t.percentage.toFixed(1)}}),ne=L(()=>q.value.percentage),re=L(()=>(G.value,y.isCompleted()));de(k,t=>{if(!f.value)return;const n=t.trim().toLowerCase(),v=f.value.code.toLowerCase();n.length>=v.length&&(n===v?oe():x.value||K())});const oe=()=>{f.value&&(h.value=!0,y.recordSuccess(z.value),G.value++,N())},K=()=>{f.value&&(h.value=!1,F.value++,x.value=!0,y.recordFailure(z.value),G.value++,k.value="",A(()=>{var t;(t=j.value)==null||t.focus()}))},N=()=>{const t=y.getNextIndex();if(t!==null)z.value=t;else return;h.value=!0,F.value=0,k.value="",y.isFirstTime(z.value)?x.value=!0:x.value=!1,A(()=>{var n;(n=j.value)==null||n.focus()})},se=()=>{Z.value||(y.reset(),z.value=0,k.value="",x.value=!1,h.value=!0,F.value=0,r.value=[],s.value=0,y.initializeWithGroupCount(m.length),N(),G.value++,r.value.push(`[${new Date().toLocaleTimeString()}] å­¸ç¿’é€²åº¦å·²é‡ç½®`))},le=()=>{se()},U=t=>{t.key==="Escape"&&!x.value&&(K(),t.preventDefault())},Q=t=>{const n=he(t,g.chaifenMap),v=e.value<768,D=e.value<1024;let P=4;return v?P=2:D&&(P=3),n.slice(0,P).split("").join("")};return J(()=>{y.initializeWithGroupCount(m.length),A(()=>{var t;(t=j.value)==null||t.focus()}),document.addEventListener("keydown",U),N()}),X(()=>{document.removeEventListener("keydown",U)}),(t,n)=>(u(),l(Y,null,[re.value?(u(),l("div",be,[a("div",ke,[n[3]||(n[3]=a("div",{class:"text-6xl mb-4"},"ğŸ‰",-1)),n[4]||(n[4]=a("h2",{class:"text-4xl font-bold mb-2"},"æ­å–œä½ å®Œæˆç·´ç¿’ï¼",-1)),a("p",we," ä½ å·²ç¶“å®Œæˆäº† "+C(B(m).length)+" å€‹å­—æ ¹çµ„çš„ç·´ç¿’ã€‚ æ„Ÿè¬ä½ çš„åŠªåŠ›å’Œå …æŒï¼Œç‚ºä¸­è¯æ–‡æ˜å’Œæ¼¢å­—çš„å‚³æ‰¿åˆå¢æ·»äº†ä¸€ä»½åŠ›é‡ï¼ ",1)]),a("div",{class:"space-y-4"},[a("button",{onClick:le,class:"px-8 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors duration-200 font-medium"}," æƒ³è¦å†è¨“ç·´ä¸€è¼ªå—ï¼Ÿ "),n[5]||(n[5]=a("div",{class:"text-sm text-gray-500 dark:text-gray-400"}," ç¹¼çºŒç·´ç¿’ä»¥éå›ºè¨˜æ†¶ ",-1))])])):f.value?(u(),l("div",{key:1,class:o(["mx-auto p-6 space-y-6",e.value<768?"max-w-sm p-3 space-y-3":"max-w-2xl"])},[a("div",Ce,[a("div",{class:o(["text-center text-gray-600 dark:text-gray-400",e.value<768?"text-xs":"text-sm"])},[a("div",{class:o(["flex justify-between items-center",e.value<768?"mb-1":"mb-2"])},[a("span",null,"å·²ç·´ç¿’: "+C(q.value.current)+" / "+C(q.value.total)+" ("+C(q.value.percentage)+"%) | å·²æŒæ¡: "+C(q.value.mastered),1),F.value>0?(u(),l("span",Se,"éŒ¯èª¤æ¬¡æ•¸: "+C(F.value),1)):M("",!0)],2),a("div",{class:o(["w-full bg-gray-200 dark:bg-gray-700 rounded-full",e.value<768?"h-1.5":"h-2"])},[a("div",{class:o(["bg-blue-500 dark:bg-blue-400 rounded-full transition-all duration-300",e.value<768?"h-1.5":"h-2"]),style:ce(`width: ${ne.value}%`)},null,6)],2)],2)]),a("div",{class:o(["w-full shadow-lg rounded-2xl transition-all duration-300 transform relative",{"bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800":!h.value,"bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800":h.value},"border-2 hover:shadow-xl"])},[a("div",{class:o(["absolute flex gap-2 z-10",e.value<768?"bottom-2 right-2":"bottom-4 right-4"])},[B(T)?(u(),l("button",{key:0,onClick:n[0]||(n[0]=(...v)=>B(T)&&B(T)(...v)),class:o(["rounded-full font-medium transition-all duration-200 flex items-center justify-center shadow-md",e.value<768?"w-6 h-6 text-xs":"w-8 h-8 text-xs",B(S)?"bg-orange-500 hover:bg-orange-600 text-white":"bg-gray-200 hover:bg-gray-300 text-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-200"]),title:B(S)?"å­—é »åº (é»æ“Šåˆ‡æ›åˆ°å­—å…¸åº)":"å­—å…¸åº (é»æ“Šåˆ‡æ›åˆ°å­—é »åº)"},[(u(),l("svg",{class:o(e.value<768?"w-2 h-2":"w-3 h-3"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...n[6]||(n[6]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"},null,-1)])],2))],10,ze)):M("",!0),B(I)?(u(),l("button",{key:1,onClick:i,class:o(["rounded-full bg-red-500 hover:bg-red-600 text-white font-medium transition-all duration-200 flex items-center justify-center shadow-md",e.value<768?"w-6 h-6 text-xs":"w-8 h-8 text-xs"]),title:"é‡æ–°é–‹å§‹è¨“ç·´"},[(u(),l("svg",{class:o(e.value<768?"w-2 h-2":"w-3 h-3"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...n[7]||(n[7]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))],2)):M("",!0)],2),a("div",{class:o(["text-center",e.value<768?"py-4":"py-12"])},[a("div",{class:o(["flex justify-center items-center flex-wrap",e.value<768?"mb-4":"mb-12",R.value])},[(u(!0),l(Y,null,ge(f.value.zigens,(v,D)=>(u(),l("div",{key:D,class:"flex flex-col items-center group"},[a("div",{class:o(["zigen-font transform transition-all duration-300 group-hover:scale-110",e.value<768?"mb-1":"mb-4",d.value,{"text-red-500 dark:text-red-400":!h.value,"text-blue-700 dark:text-blue-300":h.value}])},C(v.font),3),x.value?(u(),l("div",{key:0,class:o(["text-sm text-gray-600 dark:text-gray-300 font-mono bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",e.value<768?"text-xs px-1 py-0.5":""])},C(v.ma),3)):M("",!0),Q(v.font)?(u(),l("div",{key:1,class:o(["text-gray-600 dark:text-gray-300 font-medium tracking-tight zigen-font",e.value<768?"mt-0.5":"mt-2",{"text-xs":e.value<768,"text-base":e.value>=768&&e.value<1024,"text-lg":e.value>=1024}])},C(Q(v.font)),3)):M("",!0)]))),128))],2)],2),a("div",{class:o(["flex justify-center",e.value<768?"pb-3":"pb-8"])},[ve(a("input",{ref_key:"inputElement",ref:j,"onUpdate:modelValue":n[1]||(n[1]=v=>k.value=v),type:"text",placeholder:"ç·¨ç¢¼",class:o(["text-center border-2 rounded-xl font-mono","transition-all duration-300 focus:outline-none focus:ring-4",e.value<768?"px-3 py-2 text-lg w-32":"px-6 py-4 text-2xl w-48",{"border-red-300 focus:border-red-500 focus:ring-red-200 bg-red-50 dark:border-red-700 dark:focus:border-red-500 dark:focus:ring-red-900/50 dark:bg-red-900/20 dark:text-white":!h.value,"border-blue-300 focus:border-blue-500 focus:ring-blue-200 bg-white dark:border-blue-700 dark:focus:border-blue-500 dark:focus:ring-blue-900/50 dark:bg-gray-800 dark:text-white":h.value}])},null,2),[[fe,k.value]])],2),a("div",{class:o(["text-center transition-all duration-300",e.value<768?"pb-3":"pb-8",{"opacity-0 transform translate-y-2":!x.value,"opacity-100":x.value}])},[a("div",{class:o(["inline-block bg-gray-100 dark:bg-gray-800 rounded-lg",e.value<768?"px-2 py-1":"px-4 py-2"])},[a("span",{class:o(["text-gray-800 dark:text-gray-200",e.value<768?"text-sm":""])},"ç­”æ¡ˆæ˜¯",2),a("span",{class:o(["font-mono font-bold text-blue-600 dark:text-blue-400",e.value<768?"text-lg":"text-xl"])},C(f.value.code),3)],2)],2)],2),a("div",{class:o(["text-center text-gray-500 dark:text-gray-400 space-y-1",e.value<768?"text-xs":"text-sm"])},[x.value?(u(),l("div",Be," ç¹¼çºŒè¼¸å…¥æ­£ç¢ºç·¨ç¢¼ ")):(u(),l("div",{key:0,class:o(["flex items-center justify-center",e.value<768?"gap-2 flex-col":"gap-4"])},[a("span",_e,[a("kbd",{class:o(["bg-gray-100 dark:bg-gray-800 dark:text-gray-300 rounded",e.value<768?"px-1 py-0.5 text-xs":"px-2 py-1 text-xs"])},"è¼¸å…¥",2),n[8]||(n[8]=ee(" è‡ªå‹•æª¢æŸ¥ ",-1))]),a("span",$e,[a("kbd",{class:o(["bg-gray-100 dark:bg-gray-800 dark:text-gray-300 rounded",e.value<768?"px-1 py-0.5 text-xs":"px-2 py-1 text-xs"])},"Esc",2),n[9]||(n[9]=ee(" é¡¯ç¤ºç­”æ¡ˆ ",-1))])],2))],2)],2)):M("",!0),_.value?(u(),l("div",{key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:b},[a("div",{class:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-sm mx-4 shadow-xl",onClick:n[2]||(n[2]=pe(()=>{},["stop"]))},[n[10]||(n[10]=xe('<div class="flex items-center gap-3 mb-4" data-v-a42669f4><div class="w-10 h-10 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center" data-v-a42669f4><svg class="w-6 h-6 text-orange-600 dark:text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-a42669f4><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z" data-v-a42669f4></path></svg></div><div data-v-a42669f4><h3 class="text-lg font-medium text-gray-900 dark:text-gray-100" data-v-a42669f4>ç¢ºèªé‡ç½®</h3><p class="text-sm text-gray-600 dark:text-gray-400" data-v-a42669f4>æ‚¨ç¢ºå®šè¦é‡æ–°é–‹å§‹è¨“ç·´å—ï¼Ÿ</p></div></div><p class="text-sm text-gray-600 dark:text-gray-400 mb-6" data-v-a42669f4> é€™å°‡æ¸…é™¤ç•¶å‰çš„å­¸ç¿’é€²åº¦å’Œçµ±è¨ˆæ•¸æ“šï¼Œç„¡æ³•æ¢å¾©ã€‚ </p>',2)),a("div",{class:"flex gap-3 justify-end"},[a("button",{onClick:b,class:"px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors"}," å–æ¶ˆ "),a("button",{onClick:$,class:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors"}," ç¢ºèªé‡ç½® ")])])])):M("",!0)],64))}}),je=me(Te,[["__scopeId","data-v-a42669f4"]]),Fe={key:0},Ge={key:1,class:"text-gray-700 dark:text-gray-300 text-center"},Re=ae({__name:"ZigenTrain",props:{name:{},zigenUrl:{},range:{},mode:{},supplement:{type:Boolean},ming:{type:Boolean}},setup(V){const g=V;let E=g.name+"_zigen_grouped";const m=g.range;m&&(E+=`_${m[0]}_${m[1]}`);const W=`zigen_sort_order_${g.name}`,p=c(!1),O=H(),S=H(),T=H();function I(){try{const r=localStorage.getItem(W);if(r!==null){const s=JSON.parse(r);p.value=s,console.log("è¼‰å…¥ä¿å­˜çš„æ’åºç‹€æ…‹:",s)}}catch(r){console.warn("è¼‰å…¥æ’åºç‹€æ…‹å¤±æ•—:",r)}}function y(){try{localStorage.setItem(W,JSON.stringify(p.value)),console.log("æ’åºç‹€æ…‹å·²ä¿å­˜:",p.value)}catch(r){console.warn("ä¿å­˜æ’åºç‹€æ…‹å¤±æ•—:",r)}}const z=["å£","ä¸€","æœˆ","ä¸¶","æ—¥","äºº","äº»","æ‰Œ","ç™½","åœŸ","ä¸·","äºŒ","åˆ","ä¸¿","å®€","æœ¨","å°š","è¾¶","å°","å†–","å¶","å¿ƒ","æ°µ","å…«","å¥³","å¤§","è‰¹","ğ ‚‡","åŒ•","å¯¸","ä¹Ÿ","ä¹™","æˆˆ","ç›®","è® ","ä¸","é¾°","é˜","ç«¹","äº†","å","å¤‚","ç‹","åˆ‚","å„¿","åŠ›","å‡µ","å†‚","å­","æ–¤","ç«","ç±³","ä¸","å½","çºŸ","æ–‡","ç«‹","å£«","å¤•","ä¹‚","é—¨","åœ","è‡ª","å°¤","å½³","ç¾Š","æ­¢","ç¦¾","è´","å°¸","å·¥","ä¹š","ä¸Š","å›—","è‡³","æ‰‹","ğ¬º°","è‰®","è½¦","çŸ³","ç”°","å·±","å‡ ","ç‰›","è§","èµ°","ç”²","ä¸”","å½¡","çŠ¬","å·¾","è¥¿","æ–¹","åˆ€","æ®³","ä¸ƒ","å¼“","å·´","çŸ¢","ç¤º"],j=["é³¥","çƒ","é­š","é¦¬","é¢¨","ä¾†","è»Š","é•·","é–€","é¬¥","é½’","é£›","è¦‹","è²","é¹µ","åƒ‰","éŸ‹","å’¼","é»½"],k=r=>{switch(g.mode){case"A":return r[0];case"a":return r[1];case"both":return r;default:return}};function x(r){for(const s of r.zigens){const i=z.indexOf(s.font);if(i!==-1)return i}for(const s of r.zigens){const i=j.indexOf(s.font);if(i!==-1)return 1e4+i}return 5e3}function h(r){return[...r].sort((s,i)=>{const $=x(s),b=x(i);return $-b})}function F(){console.log("åˆ‡æ›æ’åºæ¨¡å¼è¢«èª¿ç”¨ï¼Œç•¶å‰ç‹€æ…‹:",p.value),p.value=!p.value,console.log("åˆ‡æ›å¾Œç‹€æ…‹:",p.value),y(),_(),console.log("æ’åºæ‡‰ç”¨å®Œæˆï¼ŒæŒ‰éˆ•æ‡‰è©²é¡¯ç¤ºç‚º:",p.value?"æ©™è‰²ï¼ˆå­—é »åºï¼‰":"ç°è‰²ï¼ˆå­—å…¸åºï¼‰"),setTimeout(()=>{window.location.reload()},100)}function _(){O.value?(p.value?(S.value=h(O.value),console.log("å·²åˆ‡æ›åˆ°å­—é »åºï¼Œé‡æ–°æ’åºäº†",S.value.length,"å€‹å­—æ ¹çµ„")):(S.value=[...O.value],console.log("å·²åˆ‡æ›åˆ°å­—å…¸åºï¼Œæ¢å¾©åŸå§‹é †åº")),A(()=>{console.log("æ’åºæ›´æ–°å®Œæˆï¼Œç•¶å‰é †åº:",S.value.slice(0,3).map(r=>r.code))})):console.warn("originalCardGroups æœªåˆå§‹åŒ–ï¼Œç„¡æ³•æ‡‰ç”¨æ’åº")}function G(r){var b,e;const s=[];let i=0;const $=[];console.log("=== å¼€å§‹åˆ†ç»„å­—æ ¹ ==="),console.log("è¾“å…¥å­—æ ¹æ€»æ•°:",r.length),console.log("ç»ƒä¹ æ¨¡å¼:",g.mode);for(let w=0;w<r.length;w++){const d=r[w],R=(b=k(d.ma))==null?void 0:b.toLowerCase();if(!R){i++,$.push({font:d.font,ma:d.ma,reason:`getCodeè¿”å›ç©ºå€¼ï¼Œmode=${g.mode}`}),console.warn(`è·³è¿‡å­—æ ¹ ${w}: ${d.font} (${d.ma}) - getCodeè¿”å›: ${k(d.ma)}`);continue}const f=w>0?r[w-1]:null;(f?(e=k(f.ma))==null?void 0:e.toLowerCase():null)===R&&s.length>0&&s[s.length-1].code===R?s[s.length-1].zigens.push(d):s.push({code:R,zigens:[d]})}return console.log("=== åˆ†ç»„å®Œæˆ ==="),console.log("æœ‰æ•ˆç»„æ•°:",s.length),console.log("è·³è¿‡çš„å­—æ ¹æ•°:",i),i>0&&(console.log("è·³è¿‡çš„å­—æ ¹è¯¦æƒ…:",$),console.log("å‰10ä¸ªè·³è¿‡çš„å­—æ ¹åŸå› ç»Ÿè®¡:"),$.slice(0,10).map(d=>`${d.font}(${d.ma}): ${d.reason}`).forEach(d=>console.log(`  - ${d}`))),s}function Z(){O.value&&(new te(E).reset(),p.value=!1,y(),_(),console.log("è¨“ç·´å·²é‡ç½®ï¼Œæ’åºç‹€æ…‹é‡ç½®ç‚ºå­—å…¸åº"))}return J(async()=>{I();const i=["joy","light","star","ming","wafel"].includes(g.name)?"/chaifen.json":`/chaifen-${g.name}.json`;console.log(`å­—æ ¹è®­ç»ƒæ–¹æ¡ˆ: ${g.name}, ä½¿ç”¨æ‹†åˆ†æ–‡ä»¶: ${i}`),T.value=await ue(i);let b=[...(await ie(g.zigenUrl)).values()];m&&(b=b.slice(m[0],m[1]));const e=G(b);O.value=e,_(),console.log(`å­—æ ¹ç·´ç¿’ï¼šå…± ${e.length} å€‹ç·¨ç¢¼çµ„ï¼ŒåŒ…å« ${b.length} å€‹å­—æ ¹ï¼Œç•¶å‰${p.value?"å­—é »åº":"å­—å…¸åº"}`)}),(r,s)=>S.value&&T.value?(u(),l("div",Fe,[ye(je,{name:B(E),"card-groups":S.value,"chaifen-map":T.value,mode:"g",supplement:g.supplement??!1,ming:g.ming??!1,"is-frequency-order":p.value,"on-toggle-sort":F,"on-reset":Z},null,8,["name","card-groups","chaifen-map","supplement","ming","is-frequency-order"])])):(u(),l("h2",Ge," ä¸‹è¼‰è³‡æ–™ä¸­â€¦â€¦ "))}});export{Re as _};
